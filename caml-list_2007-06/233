Return-Path: <pechtcha@cs.nyu.edu>
X-Spam-Checker-Version: SpamAssassin 3.1.3 (2006-06-01) on yquem.inria.fr
X-Spam-Level: 
X-Spam-Status: No, score=0.0 required=5.0 tests=none autolearn=disabled 
	version=3.1.3
X-Original-To: caml-list@yquem.inria.fr
Delivered-To: caml-list@yquem.inria.fr
Received: from discorde.inria.fr (discorde.inria.fr [192.93.2.38])
	by yquem.inria.fr (Postfix) with ESMTP id C5CEEBC0A
	for <caml-list@yquem.inria.fr>; Wed, 13 Jun 2007 15:45:00 +0200 (CEST)
Received: from access1.cims.nyu.edu (ACCESS1.CIMS.NYU.EDU [128.122.81.155])
	by discorde.inria.fr (8.13.6/8.13.6) with ESMTP id l5DDixNO029297
	(version=TLSv1/SSLv3 cipher=EDH-RSA-DES-CBC3-SHA bits=168 verify=NO)
	for <caml-list@yquem.inria.fr>; Wed, 13 Jun 2007 15:45:00 +0200
Received: from localhost (localhost [127.0.0.1])
	by access1.cims.nyu.edu (8.13.8+Sun/8.13.8) with ESMTP id l5DDiiro017407;
	Wed, 13 Jun 2007 09:44:44 -0400 (EDT)
Date: Wed, 13 Jun 2007 09:44:44 -0400 (EDT)
From: Igor Peshansky <pechtcha@cs.nyu.edu>
X-X-Sender: pechtcha@access1.cims.nyu.edu
Reply-To: caml-list@yquem.inria.fr
To: skaller <skaller@users.sourceforge.net>
Cc: caml-list@yquem.inria.fr, Rhythmic Fistman <rfistman@gmail.com>,
	Emmanuel Onzon <emmanuel.onzon@ens-lyon.fr>
Subject: Re: [Caml-list] cywgin stack overflow
In-Reply-To: <1181738340.6135.6.camel@rosella.wigram>
Message-ID: <Pine.GSO.4.63.0706130858580.23164@access1.cims.nyu.edu>
References: <1181720072.23474.13.camel@rosella.wigram> <1181738340.6135.6.camel@rosella.wigram>
Importance: Normal
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Miltered: at discorde with ID 466FF4DB.002 by Joe's j-chkmail (http://j-chkmail . ensmp . fr)!
X-Spam: no; 0.00; stack:01 ocaml:01 cygwin:01 cygwin:01 ocaml:01 stack:01 parser:01 recursive:01 ocamlopt:01 parser:01 ocamlopt:01 cmx:01 compiler:01 cmx:01 ocamlc:01 

On Wed, 13 Jun 2007, skaller wrote:

> On Wed, 2007-06-13 at 17:34 +1000, skaller wrote:
> > Hi, we've got a problem with an Ocaml native code program running under
> > Cygwin exiting without producing output or diagnostics. I think
> > Cygwin is running Ocaml 3.08. It was suggested
> > this was probably a stack overflow. The program is Dypgen GLR
> > parser generator, which is probably heavily recursive. It works
> > fine on my AMD64/Ubuntu Linux box, Ocaml 3.10-dev+25 or something.
> >
> > Does anyone know how to increase the stack size, or have any other
> > idea how to work around this problem? Or any idea if it could
> > be any other problem?
>
> Woops! I misdiagnosed the problem I think. I put -ccopts and
> dypgen runs fine .. however Ocamlopt.opt does not compile it
> the generated file ;(
>
> The file src/flx_parser.ml is generated by Dypgen, but ocamlopt.opt
> doesn't compile it, nor issue any diagnostic (not even returning
> with an error code). It just completes without generating a
> src/flx_parse.cmx file.
>
> Unfortunately, recompiling Ocaml on Cygwin isn't an option.
> Is there someone here maintaining the Cygwin port?

Yes.  I am.  But I haven't yet had a chance to build anything newer than
3.08.

> Any chance of 3.09 series Ocaml, and, with the native
> code compiler built with a larger stack?

I thought Ocaml had growable stacks...  I must've been confused.

Besides, I'm planning to build a 3.10 series shortly -- is there really a
pressing need for 3.09?

> I've yet to try running with larger memory for Cygwin as
> suggested by Igor -- the ml file is quite large:
>
>  20555  92221 804093 src/flx_parse.ml
>
> src/flx_parse.cmx on amd64/Ubuntu is 83569 bytes.
>
> I also suppose I can try ocamlopt (sans .opt) or even
> ocamlc (ouch!).

Do try to increase the available memory -- the amount Cygwin allocates by
default is rather small (256M, I believe).  Another possibility is to run
the compilation under strace to see why it exits.
	Igor
-- 
				http://cs.nyu.edu/~pechtcha/
      |\      _,,,---,,_	    pechtcha@cs.nyu.edu | igor@watson.ibm.com
ZZZzz /,`.-'`'    -.  ;-;;,_		Igor Peshansky, Ph.D. (name changed!)
     |,4-  ) )-,_. ,\ (  `'-'		old name: Igor Pechtchanski
    '---''(_/--'  `-'\_) fL	a.k.a JaguaR-R-R-r-r-r-.-.-.  Meow!

Freedom is just another word for "nothing left to lose"...  -- Janis Joplin

