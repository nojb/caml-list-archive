Return-Path: <dra-news@metastack.com>
X-Original-To: caml-list@sympa.inria.fr
Delivered-To: caml-list@sympa.inria.fr
Received: from mail3-relais-sop.national.inria.fr (mail3-relais-sop.national.inria.fr [192.134.164.104])
	by sympa.inria.fr (Postfix) with ESMTPS id 145BB7FEE2
	for <caml-list@sympa.inria.fr>; Tue, 23 Feb 2016 14:53:41 +0100 (CET)
IronPort-PHdr: 9a23:vNVgCRDgtme0gSSlQcw/UyQJP3N1i/DPJgcQr6AfoPdwSP78rsbcNUDSrc9gkEXOFd2CrakU1KyL7eu9AiQp2tWojjMrSNR0TRgLiMEbzUQLIfWuLgnFFsPsdDEwB89YVVVorDmROElRH9viNRWJ+iXhpQAbFhi3DwdpPOO9QteU1JTokb3ssMCIKyxzxxODIppKZC2sqgvQssREyaBDEY0WjiXzn31TZu5NznlpL1/A1zz158O34YIxu38I46Fp34d6XK77Z6U1S6BDRHRjajhtpZ6jiR6WByyk734YGkEXiQYCS1zO5RT+G5PwqTfSt+xn2SDcM9egHp4uXjH3pYtiVh7kwA4DMyU+6Hmdwph8lqseph++vDR6zpLde52cP/k4daTYK4BJDVFdV9pcAnQSSri3aJECWq9YZb5V
Authentication-Results: mail3-smtp-sop.national.inria.fr; spf=None smtp.pra=dra-news@metastack.com; spf=Pass smtp.mailfrom=dra-news@metastack.com; spf=None smtp.helo=postmaster@outmail149075.authsmtp.net
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  dra-news@metastack.com) identity=pra; client-ip=62.13.149.75;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="dra-news@metastack.com";
  x-sender="dra-news@metastack.com";
  x-conformance=sidf_compatible
Received-SPF: Pass (mail3-smtp-sop.national.inria.fr: domain of
  dra-news@metastack.com designates 62.13.149.75 as permitted
  sender) identity=mailfrom; client-ip=62.13.149.75;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="dra-news@metastack.com";
  x-sender="dra-news@metastack.com";
  x-conformance=sidf_compatible; x-record-type="v=spf1"
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  postmaster@outmail149075.authsmtp.net) identity=helo;
  client-ip=62.13.149.75;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="dra-news@metastack.com";
  x-sender="postmaster@outmail149075.authsmtp.net";
  x-conformance=sidf_compatible
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: A0BcAAAWY8xWk0uVDT5ehAynfQEGgVWReAENgWYdhzA4FAEBAQEBAQEBEAEBAQEJCwsHIS+CLYIbAwUCHhI6EgUWUiMNAQ4BBB4FC4gEAQmdTZ5OGgSFSokRhGAFlwcBgUOEE5Z2Ao5JHgEBglaBUIdpgToBAQE
X-IPAS-Result: A0BcAAAWY8xWk0uVDT5ehAynfQEGgVWReAENgWYdhzA4FAEBAQEBAQEBEAEBAQEJCwsHIS+CLYIbAwUCHhI6EgUWUiMNAQ4BBB4FC4gEAQmdTZ5OGgSFSokRhGAFlwcBgUOEE5Z2Ao5JHgEBglaBUIdpgToBAQE
X-IronPort-AV: E=Sophos;i="5.22,489,1449529200"; 
   d="scan'208";a="165705905"
Received: from outmail149075.authsmtp.net ([62.13.149.75])
  by mail3-smtp-sop.national.inria.fr with ESMTP; 23 Feb 2016 14:53:40 +0100
Received: from mail-c232.authsmtp.com (mail-c232.authsmtp.com [62.13.128.232])
	by punt20.authsmtp.com (8.14.2/8.14.2/) with ESMTP id u1NDrdNv001091
	for <caml-list@inria.fr>; Tue, 23 Feb 2016 13:53:39 GMT
Received: from romulus.metastack.com (114.212-105-213.static.virginmediabusiness.co.uk [213.105.212.114])
	(authenticated bits=0)
	by mail.authsmtp.com (8.14.2/8.14.2/) with ESMTP id u1NDrbnX058769
	for <caml-list@inria.fr>; Tue, 23 Feb 2016 13:53:37 GMT
Received: from Altus ([172.16.0.18])
	(authenticated bits=0)
	by romulus.metastack.com (8.14.2/8.14.2) with ESMTP id u1NDrb78018794
	(version=TLSv1/SSLv3 cipher=AES256-SHA bits=256 verify=NO)
	for <caml-list@inria.fr>; Tue, 23 Feb 2016 13:53:37 GMT
From: "David Allsopp" <dra-news@metastack.com>
To: "OCaml List" <caml-list@inria.fr>
Date: Tue, 23 Feb 2016 13:50:41 -0000
Organization: MetaStack Solutions Ltd.
Message-ID: <001701d16e41$2f194590$8d4bd0b0$@metastack.com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 14.0
Thread-Index: AdFuPeWuGQFMs/7RSg24JSjZZ/RxGQ==
Content-Language: en-gb
X-Scanned-By: MIMEDefang 2.65 on 172.16.0.20
X-Server-Quench: d6c91989-da34-11e5-829e-00151795d556
X-AuthReport-Spam: If SPAM / abuse - report it at: http://www.authsmtp.com/abuse
X-AuthRoute: OCd1ZAARAlZZVg1f DC4bFwdFRBksPQFF ChxFJgxfNlEAUAAU NkdBMnJSNkcdTBdX QSgJWEsiBQ9uW2N0 bRpQbg9YYUBNV0to UUtXQ1JXCgdpAwIA BxoBUBxtd0sDeQAE JxQ8NnBeVEN8fAh+ QUhcWzkANm5hYWgW TRQJdAdJcQIfewJN aFkqSXMNYGAGYXNl E1JuYSYYGxMNYCFO XBpIMVUVRV1j
X-Authentic-SMTP: 61633634383431.1037:706
X-AuthFastPath: 0 (Was 255)
X-AuthSMTP-Origin: 213.105.212.114/25
X-AuthVirus-Status: No virus detected - but ensure you scan with your own anti-virus system.
Subject: [Caml-list] ANN: msvs-tools

Of potential interest to Windows OCaml users, I'm pleased to announce a
preliminary release of "msvs-tools", a collection of scripts (at the moment
only 2) for aiding the use of the Microsoft C Compiler with OCaml. GitHub
repo at https://github.com/metastack/msvs-tools.

msvs-detect searches for Visual Studio and Windows SDKs for compilers
matching a set of criteria. Its intended use is for configure scripts, where
it can be used to remove the requirement for the user to set-up PATH, LIB
and INCLUDE prior to launching Cygwin, or to find pairs of x86 and x64 C
compilers.

msvs-promote-path provides one solution to the conflict between Microsoft's
Linker (link.exe) and coreutils link (/usr/bin/link) in Cygwin by performing
a little PATH munging so you don't have to.

msvs-detect will hopefully be heading into FlexDLL (to replace an earlier
more limited version called findwinsdk) and also into OPAM-on-Windows (which
always needs pairs of compilers for x64 and x86). msvs-promote-path will
hopefully head into OCaml itself, but it'd be helpful even at this stage to
know if it works correctly on your system so, if you're using a Windows
system that has at least one Microsoft C Compiler installed and Cygwin, then
you should be able to launch a Visual Studio Command Prompt (or Windows SDK
Command Prompt) and from that run:

C:\cygwin\bin\mintty -

(adjusted as necessary, if you installed Cygwin elsewhere) and then from
bash: 

  $ link | head -1
  link: missing operand
  Try `link --help' for more information.
  $ eval $(./msvs-promote-path)
  /cygdrive/c/Program Files (x86)/Microsoft Visual Studio 9.0/VC/Bin/amd64
moved to the front of $PATH
  $ link | head -1
  Microsoft (R) Incremental Linker Version 9.00.21022.08
  $ ./msvs-detect --all
  Identified Environment C compiler as SDK6.1-x64
  Installed and usable packages:
    SDK5.2-x64
    SDK6.1-x64
    SDK6.1-x86
    SDK7.0-x64
    SDK7.0-x86
    SDK7.1-x64
    SDK7.1-x86
    VS10.0-x64
    VS10.0-x86
    VS11.0-x64
    VS11.0-x86
    VS12.0-x64
    VS12.0-x86
    VS14.0-x64
    VS14.0-x86
    VS7.0-x86
    VS7.1-x86
    VS8.0-x64
    VS8.0-x86
    VS9.0-x64
    VS9.0-x86

Obviously the output will depend on exactly what you have installed and,
yes, the test system I'm working on actually has every version of Visual
Studio and the Windows SDK simultaneously installed; thank you Microsoft for
keeping all those demo ISOs on your website and for the MSDN Academic
Alliance/e-Academy which provided me with free copies of VS .NET 2002 and
2003 a veeery long time ago.

Any feedback - especially if it doesn't work - much appreciated.


David

