Received: (from majordomo@localhost) by pauillac.inria.fr (8.7.6/8.7.3) id RAA06100; Tue, 20 Mar 2001 17:35:37 +0100 (MET)
X-Authentication-Warning: pauillac.inria.fr: majordomo set sender to owner-caml-list@pauillac.inria.fr using -f
Received: from concorde.inria.fr (concorde.inria.fr [192.93.2.39]) by pauillac.inria.fr (8.7.6/8.7.3) with ESMTP id RAA05750 for <caml-list@pauillac.inria.fr>; Tue, 20 Mar 2001 17:35:36 +0100 (MET)
Received: from hci.ucsd.edu (hci.ucsd.edu [132.239.215.210])
	by concorde.inria.fr (8.11.1/8.10.0) with ESMTP id f2KGZYX10038
	for <caml-list@inria.fr>; Tue, 20 Mar 2001 17:35:35 +0100 (MET)
Received: (from dsf@localhost)
	by hci.ucsd.edu (8.9.3/8.9.3) id IAA15167;
	Tue, 20 Mar 2001 08:35:33 -0800
To: caml-list@inria.fr
Subject: [Caml-list] Patch to ocaml-3.01-2 RPM spec file
From: David Fox <dsfox@cogsci.ucsd.edu>
Date: 20 Mar 2001 08:35:33 -0800
In-Reply-To: Tom Hirschowitz's message of "Tue, 20 Mar 2001 09:32:54 +0100"
Message-ID: <luu24os8iy.fsf_-_@hci.ucsd.edu>
Lines: 67
X-Mailer: Gnus v5.7/Emacs 20.3
Sender: owner-caml-list@pauillac.inria.fr
Precedence: bulk

I thought I would contribute these changes to the latest ocaml RPM
SPEC file because I had to rebuild it anyway to get the right paths
for the emacs site lisp files.  The emacs patch just adds a line to
the Makefile to byte compile caml-font.el.

--- ocaml-3.01-2.spec	Thu Mar  8 06:28:56 2001
+++ ocaml-3.01-3.spec	Tue Mar 20 08:25:03 2001
@@ -1,16 +1,18 @@
 Name: ocaml
 Version: 3.01
-Release: 2
+Release: 3
 Summary: The Objective Caml compiler and programming environment
 Source0: ftp://ftp.inria.fr/lang/caml-light/ocaml-3.01.tar.gz
 Source1: ftp://ftp.inria.fr/lang/caml-light/ocaml-3.01-refman.html.tar.gz
 Source2: ftp://ftp.inria.fr/lang/caml-light/ocaml-3.01-refman.ps.gz
 Source3: ftp://ftp.inria.fr/lang/caml-light/ocaml-3.01-refman.info.tar.gz
+Patch: ocaml-3.01-emacs.patch
 Copyright: Open Source
 Group: Development/Languages
 BuildRoot: /var/tmp/ocaml-buildroot
 Vendor: INRIA Rocquencourt
 URL: http://caml.inria.fr/
+BuildRequires: XFree86-devel gpm-devel ncurses-devel tcl tk emacs
 
 %description
 Objective Caml is a high-level, strongly-typed, functional and
@@ -24,27 +26,28 @@
 %setup -T -b 0
 %setup -T -D -a 1
 %setup -T -D -a 3
+%patch -p1
 cp ../../SOURCES/ocaml-3.01-refman.ps.gz refman.ps.gz
 
 %build
-./configure -bindir /usr/bin -libdir /usr/lib/ocaml -mandir /usr/man/man1
+./configure -bindir %{_bindir} -libdir %{_libdir}/ocaml -mandir %{_mandir}/man1
 make world opt ocamlc.opt ocamlopt.opt
 
 %install
-rm -rf ${RPM_BUILD_ROOT}/usr/lib/ocaml
-make install BINDIR=${RPM_BUILD_ROOT}/usr/bin LIBDIR=${RPM_BUILD_ROOT}/usr/lib/ocaml MANDIR=${RPM_BUILD_ROOT}/usr/man/man1
-(cd emacs; make install BINDIR=${RPM_BUILD_ROOT}/usr/bin EMACSDIR=${RPM_BUILD_ROOT}/usr/lib/emacs/site-lisp)
-(mkdir -p ${RPM_BUILD_ROOT}/usr/info; cd infoman; cp ocaml*.gz ${RPM_BUILD_ROOT}/usr/info)
+rm -rf %{buildroot}%{_libdir}/ocaml
+make install BINDIR=%{buildroot}%{_bindir} LIBDIR=%{buildroot}%{_libdir}/ocaml MANDIR=%{buildroot}%{_mandir}/man1
+(cd emacs; make install BINDIR=%{buildroot}%{_bindir} EMACSDIR=%{buildroot}%{_datadir}/emacs/site-lisp)
+(mkdir -p %{buildroot}%{_infodir}; cd infoman; cp ocaml*.gz %{buildroot}%{_infodir})
 
 # Disable build root strip policy, executables generated by ocamlc -custom
 # MUST NOT BE STRIPPED
 %define __spec_install_post /usr/lib/rpm/brp-compress
 
 %files
-/usr/bin/*
-/usr/man/man1/*
-/usr/lib/ocaml
-/usr/lib/emacs/site-lisp/*
-/usr/info/*
+%{_bindir}/*
+%{_mandir}/man1/*
+%{_libdir}/ocaml
+%{_datadir}/emacs/site-lisp/*
+%{_infodir}/*
 
 %doc refman.ps.gz htmlman

-------------------
To unsubscribe, mail caml-list-request@inria.fr.  Archives: http://caml.inria.fr

