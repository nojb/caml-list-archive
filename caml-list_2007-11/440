Return-Path: <jon@ffconsultancy.com>
X-Spam-Checker-Version: SpamAssassin 3.1.3 (2006-06-01) on yquem.inria.fr
X-Spam-Level: 
X-Spam-Status: No, score=0.0 required=5.0 tests=AWL autolearn=disabled 
	version=3.1.3
X-Original-To: caml-list@yquem.inria.fr
Delivered-To: caml-list@yquem.inria.fr
Received: from mail2-relais-roc.national.inria.fr (mail2-relais-roc.national.inria.fr [192.134.164.83])
	by yquem.inria.fr (Postfix) with ESMTP id BABA9BC69
	for <caml-list@yquem.inria.fr>; Sat, 24 Nov 2007 02:05:26 +0100 (CET)
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: Ao8CAKcHR0fUnw7Vg2dsb2JhbACCOY0EAQEBCAQGIgc
X-IronPort-AV: E=Sophos;i="4.21,459,1188770400"; 
   d="scan'208";a="4556875"
Received: from ptb-relay02.plus.net ([212.159.14.213])
  by mail2-smtp-roc.national.inria.fr with ESMTP; 24 Nov 2007 02:05:26 +0100
Received: from [80.229.56.224] (helo=beast.local)
	 by ptb-relay02.plus.net with esmtp (Exim) id 1IvjSV-00031z-OW
	for caml-list@yquem.inria.fr; Sat, 24 Nov 2007 01:05:25 +0000
From: Jon Harrop <jon@ffconsultancy.com>
Organization: Flying Frog Consultancy Ltd.
To: caml-list@yquem.inria.fr
Subject: Re: [Caml-list] Floating exception
Date: Fri, 23 Nov 2007 22:36:39 +0000
User-Agent: KMail/1.9.5
References: <47471716.3020304@irisa.fr>
In-Reply-To: <47471716.3020304@irisa.fr>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711232236.39691.jon@ffconsultancy.com>
X-Spam: no; 0.00; ocaml:01 ocaml:01 3.08:01 ocamlopt:01 ocamlopt:01 renderer:01 bytecode:01 interop:01 interop:01 bytecode:01 presenta:98 smoke:98 smoke:98 tiger:98 frog:98 

On Friday 23 November 2007 18:08, Sebastien Ferre wrote:
> I compiled an OCaml program in native code on
> my new Linux machine. It runs without problem on
> this machine, but crashes as soon as it is executed
> with "Floating exception" on another Linux machine.
> The 2 machines have a similar processors (Intel Core Duo
> and Intel Xeon).
>
> What puzzles me is that it was working properly
> with my previous machine, which was very similar
> to the new one (Dell D400 -> D420).
> Another change is that I shifted from OCaml 3.08
> to OCaml 3.09.
>
> Does anybody have an idea of the cause of such an
> obscure error ? and how to solve it ? :-)

We shipped our first and last binary commercial product written in OCaml about 
two and a half years ago: presentation software for technical users 
called "Presenta" that provided integrated real-time 2D and 3D graphics 
rendered via OpenGL.

Too many of our users found the binary generated by ocamlopt to be unusably 
unreliable, typically due to random segfaulting that we could not reproduce. 
Consequently, we were forced to shelve the product line and never bothered 
trying to sell binaries generated by ocamlopt again. We've since stripped out 
the core renderer (Smoke) and are now giving it away for free in bytecode 
form and selling the source code:

  http://www.ffconsultancy.com/products/smoke_vector_graphics/

I was interested to hear about John Whitington's commercial product cPDF:

  http://www.coherentgraphics.co.uk/cpdf.html

I believe our problems were with library interop (e.g. using OpenGL from 
OCaml). cPDF works perfectly here but requires very little interop by 
comparison.

What libraries are you using and what exactly is your link line?

The situation may have improved since then. We have binary demos for x86 and 
x86-64 Linux on our site:

  http://www.ffconsultancy.com/products/smoke_vector_graphics/demo1.html
  http://www.ffconsultancy.com/products/smoke_vector_graphics/demo2.html
  http://www.ffconsultancy.com/products/smoke_vector_graphics/tiger.html

I'd be interested to hear if anyone can run the bytecode version of Smoke or 
these binaries. I'll put Mac OS X and Windows ones up ASAP.

If anyone has any ideas of how this might be improved I'd love to hear them!

-- 
Dr Jon D Harrop, Flying Frog Consultancy Ltd.
http://www.ffconsultancy.com/products/?e

