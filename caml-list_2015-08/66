Return-Path: <agarwal1975@gmail.com>
X-Original-To: caml-list@sympa.inria.fr
Delivered-To: caml-list@sympa.inria.fr
Received: from mail3-relais-sop.national.inria.fr (mail3-relais-sop.national.inria.fr [192.134.164.104])
	by sympa.inria.fr (Postfix) with ESMTPS id 085BC7EEBF
	for <caml-list@sympa.inria.fr>; Thu,  6 Aug 2015 21:03:32 +0200 (CEST)
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  agarwal1975@gmail.com) identity=pra;
  client-ip=209.85.212.182;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="agarwal1975@gmail.com";
  x-sender="agarwal1975@gmail.com";
  x-conformance=sidf_compatible
Received-SPF: Pass (mail3-smtp-sop.national.inria.fr: domain of
  agarwal1975@gmail.com designates 209.85.212.182 as permitted
  sender) identity=mailfrom; client-ip=209.85.212.182;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="agarwal1975@gmail.com";
  x-sender="agarwal1975@gmail.com";
  x-conformance=sidf_compatible; x-record-type="v=spf1"
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  postmaster@mail-wi0-f182.google.com) identity=helo;
  client-ip=209.85.212.182;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="agarwal1975@gmail.com";
  x-sender="postmaster@mail-wi0-f182.google.com";
  x-conformance=sidf_compatible
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: A0ByAgD3rsNVm7bUVdFbgk5sNWkGgx2uRosDgjOFfQKBQQdMAQEBAQEBEgEBAQEBBgsLCSEuhCQBAQMBEhEdARQHHQEDAQsGAwILAx8VAgIiAREBBQEcBhMJGYd2AQMKCA2aO48/gS4+MYs/gWyCeYtIChknDVeEVQEBAQEBAQQBAQEBAQEBFQEFDotBhGMmBwqCX4FDBYccjV8Gim+BaJgjEiOBFxEGhCgiMQGCSwEBAQ
X-IPAS-Result: A0ByAgD3rsNVm7bUVdFbgk5sNWkGgx2uRosDgjOFfQKBQQdMAQEBAQEBEgEBAQEBBgsLCSEuhCQBAQMBEhEdARQHHQEDAQsGAwILAx8VAgIiAREBBQEcBhMJGYd2AQMKCA2aO48/gS4+MYs/gWyCeYtIChknDVeEVQEBAQEBAQQBAQEBAQEBFQEFDotBhGMmBwqCX4FDBYccjV8Gim+BaJgjEiOBFxEGhCgiMQGCSwEBAQ
X-IronPort-AV: E=Sophos;i="5.15,624,1432591200"; 
   d="scan'208";a="142210328"
Received: from mail-wi0-f182.google.com ([209.85.212.182])
  by mail3-smtp-sop.national.inria.fr with ESMTP/TLS/RC4-SHA; 06 Aug 2015 21:03:31 +0200
Received: by wibhh20 with SMTP id hh20so36773570wib.0
        for <caml-list@inria.fr>; Thu, 06 Aug 2015 12:03:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :cc:content-type;
        bh=b0N2lkBqBj1oWDd7xQs6ur6zYgllJhFVSBDmNZm++5A=;
        b=K13RmTJ1TkfvM1n+jQT7kK3lL0j26CRyr93vfSi+Yl+PR5zvC9OQLyXPikta9ccaJm
         YFXSp2yfGJrRhuZuS5hx4ppw7m2TldhRI8AweqAayoQqy1Dvgbq6bnfurEyPvRhs7CjE
         NOcAGFs2jPaD8gd95fZHoHd0I2XEMStoHtPploJ8W3gAV9arhOe0i2z2beoXswu5Sy1f
         JG7FVxdnpzcXuyHc+vCff+n+Qe293kaDVRSR79NOO99+SqiEZHcX4PsIkxtlBiCac6Fr
         3vbz6U/bkiJKIgvu7Y1BantOnJk1pAbE+3rn/pbrceKeH5HqRgm/CgRsTeoSwBMUz6Mh
         JQ/A==
X-Received: by 10.194.81.67 with SMTP id y3mr6092833wjx.7.1438887810759; Thu,
 06 Aug 2015 12:03:30 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.27.95.213 with HTTP; Thu, 6 Aug 2015 12:03:11 -0700 (PDT)
In-Reply-To: <1438788990.9319.23.camel@zotac>
References: <CAMu2m2Ly8i+d-c5QUybtT_B4_WjBExi0+E8pHTPJM1Rca0+n5w@mail.gmail.com>
 <1438788990.9319.23.camel@zotac>
From: Ashish Agarwal <agarwal1975@gmail.com>
Date: Thu, 6 Aug 2015 15:03:11 -0400
Message-ID: <CAMu2m2KwF4YLeWCZyd5Ou137NAbF=+mfnWtfjWdC6g81sUD9Uw@mail.gmail.com>
To: Gerd Stolpmann <info@gerd-stolpmann.de>
Cc: Caml List <caml-list@inria.fr>
Content-Type: multipart/alternative; boundary=047d7bdc865cd502f8051ca92c2c
Subject: Re: [Caml-list] findlib gives warning that compiler doesn't

--047d7bdc865cd502f8051ca92c2c
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

> It is a little bit unclear to me how the check could be made better. Any
ideas?

I'm not sure. I'm working around the problem by putting the output of
packing in a different directory, which gives this layout:

=E2=94=9C=E2=94=80=E2=94=80 liba
=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 a.cmi
=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 a.cmo
=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 a.ml
=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 b.cmi
=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 b.cmo
=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 b.ml
=E2=94=9C=E2=94=80=E2=94=80 liba.cma
=E2=94=9C=E2=94=80=E2=94=80 liba.cmi
=E2=94=9C=E2=94=80=E2=94=80 liba.cmo
=E2=94=94=E2=94=80=E2=94=80 libb
    =E2=94=9C=E2=94=80=E2=94=80 a.cmi
    =E2=94=94=E2=94=80=E2=94=80 a.ml

Now I can do

$ ocamlfind ocamlc -I .. -c a.ml

thereby avoiding reference to the liba/ directory entirely.


On Wed, Aug 5, 2015 at 11:36 AM, Gerd Stolpmann <info@gerd-stolpmann.de>
wrote:

> Am Dienstag, den 04.08.2015, 16:49 -0400 schrieb Ashish Agarwal:
> > With the file structure shown below, assume you're in directory libb.
> > Then:
> >
> >
> > $ ocamlc -I ../liba -c a.ml
> > (* no warnings *)
> >
> >
> > $ ocamlfind ocamlc -I ../liba -c a.ml
> > findlib: [WARNING] Interface a.cmi occurs in several
> > directories: ., ../liba
> >
> >
> > Why does findlib do an extra check that the compiler is okay with?
> > This is causing problems in a project where I'd like to build several
> > packed libraries, and one reason for doing so is precisely to reuse
> > module names. Am I going about this wrong? My goal is that within
> > libb, the only module from liba that should be visible is Liba.
>
> The compiler has always been okay with multiple cmis in different
> directories because the assumption is that you have full control over
> the directories, and that the search path resolves any conflicts. This
> is different when you use findlib. Typically you use libraries from
> third parties, and cmi conflicts would remain unnoticed if findlib
> didn't check.
>
> This feature, however, is older than packed modules, and findlib doesn't
> take packed modules into account. It is a little bit unclear to me how
> the check could be made better. Any ideas?
>
> Gerd
>
> >
> >
> > =E2=94=9C=E2=94=80=E2=94=80 liba
> > =E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 a.cmi
> > =E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 a.cmo
> > =E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 a.ml
> > =E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 b.cmi
> > =E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 b.cmo
> > =E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 b.ml
> > =E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 liba.cma
> > =E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 liba.cmi
> > =E2=94=82   =E2=94=94=E2=94=80=E2=94=80 liba.cmo
> > =E2=94=94=E2=94=80=E2=94=80 libb
> >     =E2=94=9C=E2=94=80=E2=94=80 a.cmi
> >     =E2=94=9C=E2=94=80=E2=94=80 a.cmo
> >     =E2=94=94=E2=94=80=E2=94=80 a.ml
> >
> >
> >
>
> --
> ------------------------------------------------------------
> Gerd Stolpmann, Darmstadt, Germany    gerd@gerd-stolpmann.de
> My OCaml site:          http://www.camlcity.org
> Contact details:        http://www.camlcity.org/contact.html
> Company homepage:       http://www.gerd-stolpmann.de
> ------------------------------------------------------------
>

--047d7bdc865cd502f8051ca92c2c
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">&gt;=C2=A0<span style=3D"font-size:12.8000001907349px">It =
is a little bit unclear to me how=C2=A0</span><span style=3D"font-size:12.8=
000001907349px">the check could be made better. Any ideas?</span><div><span=
 style=3D"font-size:12.8000001907349px"><br></span></div><div><span style=
=3D"font-size:12.8000001907349px">I&#39;m not sure. I&#39;m working around =
the problem by putting the output of packing in a different directory, whic=
h gives this layout:</span></div><div><div><div><span style=3D"font-size:12=
.8000001907349px"><br class=3D"Apple-interchange-newline">=E2=94=9C=E2=94=
=80=E2=94=80 liba</span></div><div><span style=3D"font-size:12.800000190734=
9px">=E2=94=82 =C2=A0 =E2=94=9C=E2=94=80=E2=94=80 a.cmi</span></div><div><s=
pan style=3D"font-size:12.8000001907349px">=E2=94=82 =C2=A0 =E2=94=9C=E2=94=
=80=E2=94=80 a.cmo</span></div><div><span style=3D"font-size:12.80000019073=
49px">=E2=94=82 =C2=A0 =E2=94=9C=E2=94=80=E2=94=80 <a href=3D"http://a.ml">=
a.ml</a></span></div><div><span style=3D"font-size:12.8000001907349px">=E2=
=94=82 =C2=A0 =E2=94=9C=E2=94=80=E2=94=80 b.cmi</span></div><div><span styl=
e=3D"font-size:12.8000001907349px">=E2=94=82 =C2=A0 =E2=94=9C=E2=94=80=E2=
=94=80 b.cmo</span></div><div><span style=3D"font-size:12.8000001907349px">=
=E2=94=82 =C2=A0 =E2=94=94=E2=94=80=E2=94=80 <a href=3D"http://b.ml">b.ml</=
a></span></div><div><span style=3D"font-size:12.8000001907349px">=E2=94=9C=
=E2=94=80=E2=94=80 liba.cma</span></div><div><span style=3D"font-size:12.80=
00001907349px">=E2=94=9C=E2=94=80=E2=94=80 liba.cmi</span></div><div><span =
style=3D"font-size:12.8000001907349px">=E2=94=9C=E2=94=80=E2=94=80 liba.cmo=
</span></div><div><span style=3D"font-size:12.8000001907349px">=E2=94=94=E2=
=94=80=E2=94=80 libb</span></div><div><span style=3D"font-size:12.800000190=
7349px">=C2=A0 =C2=A0 =E2=94=9C=E2=94=80=E2=94=80 a.cmi</span></div><div><s=
pan style=3D"font-size:12.8000001907349px">=C2=A0 =C2=A0 =E2=94=94=E2=94=80=
=E2=94=80 <a href=3D"http://a.ml">a.ml</a></span></div></div></div><div><sp=
an style=3D"font-size:12.8000001907349px"><br></span></div><div><span style=
=3D"font-size:12.8000001907349px">Now I can do</span></div><div><span style=
=3D"font-size:12.8000001907349px"><br></span></div><div><span style=3D"font=
-size:12.8000001907349px">$ ocamlfind ocamlc -I .. -c <a href=3D"http://a.m=
l">a.ml</a></span><br></div><div><span style=3D"font-size:12.8000001907349p=
x"><br></span></div><div><span style=3D"font-size:12.8000001907349px">there=
by avoiding reference to the liba/ directory entirely.</span></div><div><br=
></div></div><div class=3D"gmail_extra"><br><div class=3D"gmail_quote">On W=
ed, Aug 5, 2015 at 11:36 AM, Gerd Stolpmann <span dir=3D"ltr">&lt;<a href=
=3D"mailto:info@gerd-stolpmann.de" target=3D"_blank">info@gerd-stolpmann.de=
</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin=
:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">A=
m Dienstag, den 04.08.2015, 16:49 -0400 schrieb Ashish Agarwal:<br>
&gt; With the file structure shown below, assume you&#39;re in directory li=
bb.<br>
&gt; Then:<br>
&gt;<br>
&gt;<br>
&gt; $ ocamlc -I ../liba -c <a href=3D"http://a.ml" rel=3D"noreferrer" targ=
et=3D"_blank">a.ml</a><br>
&gt; (* no warnings *)<br>
&gt;<br>
&gt;<br>
&gt; $ ocamlfind ocamlc -I ../liba -c <a href=3D"http://a.ml" rel=3D"norefe=
rrer" target=3D"_blank">a.ml</a><br>
&gt; findlib: [WARNING] Interface a.cmi occurs in several<br>
&gt; directories: ., ../liba<br>
&gt;<br>
&gt;<br>
&gt; Why does findlib do an extra check that the compiler is okay with?<br>
&gt; This is causing problems in a project where I&#39;d like to build seve=
ral<br>
&gt; packed libraries, and one reason for doing so is precisely to reuse<br>
&gt; module names. Am I going about this wrong? My goal is that within<br>
&gt; libb, the only module from liba that should be visible is Liba.<br>
<br>
</span>The compiler has always been okay with multiple cmis in different<br>
directories because the assumption is that you have full control over<br>
the directories, and that the search path resolves any conflicts. This<br>
is different when you use findlib. Typically you use libraries from<br>
third parties, and cmi conflicts would remain unnoticed if findlib<br>
didn&#39;t check.<br>
<br>
This feature, however, is older than packed modules, and findlib doesn&#39;=
t<br>
take packed modules into account. It is a little bit unclear to me how<br>
the check could be made better. Any ideas?<br>
<br>
Gerd<br>
<div class=3D"HOEnZb"><div class=3D"h5"><br>
&gt;<br>
&gt;<br>
&gt; =E2=94=9C=E2=94=80=E2=94=80 liba<br>
&gt; =E2=94=82=C2=A0 =C2=A0=E2=94=9C=E2=94=80=E2=94=80 a.cmi<br>
&gt; =E2=94=82=C2=A0 =C2=A0=E2=94=9C=E2=94=80=E2=94=80 a.cmo<br>
&gt; =E2=94=82=C2=A0 =C2=A0=E2=94=9C=E2=94=80=E2=94=80 <a href=3D"http://a.=
ml" rel=3D"noreferrer" target=3D"_blank">a.ml</a><br>
&gt; =E2=94=82=C2=A0 =C2=A0=E2=94=9C=E2=94=80=E2=94=80 b.cmi<br>
&gt; =E2=94=82=C2=A0 =C2=A0=E2=94=9C=E2=94=80=E2=94=80 b.cmo<br>
&gt; =E2=94=82=C2=A0 =C2=A0=E2=94=9C=E2=94=80=E2=94=80 <a href=3D"http://b.=
ml" rel=3D"noreferrer" target=3D"_blank">b.ml</a><br>
&gt; =E2=94=82=C2=A0 =C2=A0=E2=94=9C=E2=94=80=E2=94=80 liba.cma<br>
&gt; =E2=94=82=C2=A0 =C2=A0=E2=94=9C=E2=94=80=E2=94=80 liba.cmi<br>
&gt; =E2=94=82=C2=A0 =C2=A0=E2=94=94=E2=94=80=E2=94=80 liba.cmo<br>
&gt; =E2=94=94=E2=94=80=E2=94=80 libb<br>
&gt;=C2=A0 =C2=A0 =C2=A0=E2=94=9C=E2=94=80=E2=94=80 a.cmi<br>
&gt;=C2=A0 =C2=A0 =C2=A0=E2=94=9C=E2=94=80=E2=94=80 a.cmo<br>
&gt;=C2=A0 =C2=A0 =C2=A0=E2=94=94=E2=94=80=E2=94=80 <a href=3D"http://a.ml"=
 rel=3D"noreferrer" target=3D"_blank">a.ml</a><br>
&gt;<br>
&gt;<br>
&gt;<br>
<br>
</div></div><span class=3D"HOEnZb"><font color=3D"#888888">--<br>
------------------------------------------------------------<br>
Gerd Stolpmann, Darmstadt, Germany=C2=A0 =C2=A0 <a href=3D"mailto:gerd@gerd=
-stolpmann.de">gerd@gerd-stolpmann.de</a><br>
My OCaml site:=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 <a href=3D"http://www.caml=
city.org" rel=3D"noreferrer" target=3D"_blank">http://www.camlcity.org</a><=
br>
Contact details:=C2=A0 =C2=A0 =C2=A0 =C2=A0 <a href=3D"http://www.camlcity.=
org/contact.html" rel=3D"noreferrer" target=3D"_blank">http://www.camlcity.=
org/contact.html</a><br>
Company homepage:=C2=A0 =C2=A0 =C2=A0 =C2=A0<a href=3D"http://www.gerd-stol=
pmann.de" rel=3D"noreferrer" target=3D"_blank">http://www.gerd-stolpmann.de=
</a><br>
------------------------------------------------------------<br>
</font></span></blockquote></div><br></div>

--047d7bdc865cd502f8051ca92c2c--
