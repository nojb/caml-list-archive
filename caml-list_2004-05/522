Received: (from majordomo@localhost) by pauillac.inria.fr (8.7.6/8.7.3) id PAA23759; Fri, 28 May 2004 15:52:26 +0200 (MET DST)
X-Authentication-Warning: pauillac.inria.fr: majordomo set sender to owner-caml-list@pauillac.inria.fr using -f
Received: from nez-perce.inria.fr (nez-perce.inria.fr [192.93.2.78]) by pauillac.inria.fr (8.7.6/8.7.3) with ESMTP id PAA23877 for <caml-list@pauillac.inria.fr>; Fri, 28 May 2004 15:52:25 +0200 (MET DST)
Received: from waco.inria.fr (waco.inria.fr [128.93.25.2])
	by nez-perce.inria.fr (8.12.10/8.12.10) with ESMTP id i4SDqNEV028820;
	Fri, 28 May 2004 15:52:23 +0200
Received: from waco.inria.fr (localhost [127.0.0.1])
	by waco.inria.fr (8.12.10/8.12.10) with ESMTP id i4SDqNPU031886;
	Fri, 28 May 2004 15:52:23 +0200
Received: (from verlyck@localhost)
	by waco.inria.fr (8.12.10/8.12.10/Submit) id i4SDqNnI031885;
	Fri, 28 May 2004 15:52:23 +0200
Date: Fri, 28 May 2004 15:52:23 +0200
Message-Id: <200405281352.i4SDqNnI031885@waco.inria.fr>
To: jgoerzen@complete.org
CC: caml-list@inria.fr
In-reply-to: <20040528131339.GC9268@excelhustler.com> (jgoerzen@complete.org)
Subject: Re: [Caml-list] Cash broken?
From: Bruno.Verlyck@inria.fr
References: <20040527193823.GA12789@excelhustler.com> <200405281026.i4SAQFmR031229@waco.inria.fr> <20040528131339.GC9268@excelhustler.com>
Mime-Version: 1.0 (generated by tm-edit 7.106)
Content-Type: text/plain; charset=US-ASCII
X-Miltered: at nez-perce with ID 40B74417.001 by Joe's j-chkmail (http://j-chkmail.ensmp.fr)!
X-Loop: caml-list@inria.fr
X-Spam: no; 0.00; caml-list:01 2004:99 2004:99 descriptor:01 descriptor:01 backtrace:01 truss:01 strace:01 backtrace:01 forked:01 strace:01 rank:99 bug':01 0200,:01 patch:02 
Sender: owner-caml-list@pauillac.inria.fr
Precedence: bulk

   Date: Fri, 28 May 2004 08:13:39 -0500
   From: John Goerzen <jgoerzen@complete.org>

   On Fri, May 28, 2004 at 12:26:15PM +0200, Bruno.Verlyck@inria.fr wrote:
   >     # open Cash;;
   >     # run_with_strings (fun () -> exec_path "ls" []);;
   >     Exception: Sys_error "Bad file descriptor".
   >     # Exception: Sys_error "Bad file descriptor".
   
   >    Ideas?  (Cash 0.20)
   > Would you mind sending me more OS details ?  A backtrace would be
   > very useful, and/or the result of trace/truss/strace -f ?
   This is on Debian sid, Linux 2.6.6.  I couldn't figure out how to
   get a backtrace.  However, from the forked child, I see:

   [pid  9461] close(4)			= 0
   [pid  9461] close(4)			= -1 EBADF (Bad file descriptor)

   (Full strace attached)
Thank you.  It confirms my first guess.

   Will try the patch.  How does the CVS version rank in terms of
   stability?
Pretty good :-).  The only risk is that I converted all the sources to
use Cstr/String13, and I have to admit I introduced some translation
errors.  I fixed those I found, but it could be that there's still
`just one more bug'.  I would be very interested if you (or anyone
else) find it out, or tell me everything you tried is OK.

Thanks anyway,
Bruno.

-------------------
To unsubscribe, mail caml-list-request@inria.fr Archives: http://caml.inria.fr
Bug reports: http://caml.inria.fr/bin/caml-bugs FAQ: http://caml.inria.fr/FAQ/
Beginner's list: http://groups.yahoo.com/group/ocaml_beginners

