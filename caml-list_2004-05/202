Received: (from majordomo@localhost) by pauillac.inria.fr (8.7.6/8.7.3) id UAA13685; Mon, 10 May 2004 20:17:58 +0200 (MET DST)
Received: from nez-perce.inria.fr (nez-perce.inria.fr [192.93.2.78]) by pauillac.inria.fr (8.7.6/8.7.3) with ESMTP id UAA14376 for <caml-list@pauillac.inria.fr>; Mon, 10 May 2004 20:17:57 +0200 (MET DST)
Received: from venus.is.s.u-tokyo.ac.jp (venus.is.s.u-tokyo.ac.jp [133.11.12.9])
	by nez-perce.inria.fr (8.12.10/8.12.10) with ESMTP id i4AIHsEV014485
	for <caml-list@inria.fr>; Mon, 10 May 2004 20:17:55 +0200
Received: from tuba.is.s.u-tokyo.ac.jp (tuba.is.s.u-tokyo.ac.jp [133.11.12.102])
	by venus.is.s.u-tokyo.ac.jp (8.11.6p3/3.7W) with ESMTP id i4AIHqt10899
	for <caml-list@inria.fr>; Tue, 11 May 2004 03:17:52 +0900 (JST)
Received: (from oiwa@localhost)
	by tuba.is.s.u-tokyo.ac.jp (8.11.6+Sun/3.7W) id i4AIHqY25579;
	Tue, 11 May 2004 03:17:52 +0900 (JST)
X-Authentication-Warning: tuba.is.s.u-tokyo.ac.jp: oiwa set sender to oiwa@yl.is.s.u-tokyo.ac.jp using -f
To: caml-list@inria.fr
Subject: Re: Solved!  ... Re: [Caml-list] Building findlib/OCamlfind on Win32 system
References: <409F1A40.8080407@lophty.com>
 <vfin04gk7z3.fsf@tuba.is.s.u-tokyo.ac.jp> <409FBEF1.6000403@lophty.com>
MIME-Version: 1.0 (generated by SEMI 1.14.3 - "Ushinoya")
Content-Type: text/plain; charset=US-ASCII
From: Yutaka OIWA <oiwa@yl.is.s.u-tokyo.ac.jp>
Date: Tue, 11 May 2004 03:17:51 +0900
In-Reply-To: <409FBEF1.6000403@lophty.com>
 (brian donovan's message of "Tue, 11 May 2004 01:42:09 +0800")
Message-ID: <vfifza8cfjk.fsf@tuba.is.s.u-tokyo.ac.jp>
Lines: 51
User-Agent: T-gnus/6.15.6 (based on Oort Gnus v0.06) (revision 01)
 SEMI/1.14.3 (Ushinoya) FLIM/1.14.3 (=?ISO-8859-4?Q?Unebigory=F2mae?=)
 APEL/10.2 Emacs/20.7 (sparc-sun-solaris2.8) MULE/4.0 (HANANOEN)
X-Miltered: at nez-perce with ID 409FC752.000 by Joe's j-chkmail (http://j-chkmail.ensmp.fr)!
X-Loop: caml-list@inria.fr
X-Spam: no; 0.00; caml-list:01 findlib:01 ocamlfind:01 yutaka:01 oiwa:01 oiwa:01 u-tokyo:01 2004:99 findlib:01 gerd:01 stolpmann:01 gerd:01 3.0.6:01 gerd's:01 32,:01 
Sender: owner-caml-list@pauillac.inria.fr
Precedence: bulk

>> On Tue, 11 May 2004 01:42:09 +0800, brian donovan <lists@lophty.com> said:

brian> With the patch from Eugene Kotlyarov and following his advice, I was 
brian> able to get the most recent version of findlib working with OCaml 
brian> 3.0.7.  That's solved my problems for now, but I urge you to share the 
brian> frontend.ml.ocaml307.patch with Gerd Stolpmann (email 
brian> <gerd(at)gerd-stolpmann.de>).  Undoubtedly, there will be someone at 
brian> some point who's trying to get OCaml 3.0.6 working with findlib 0.8.1 
brian> and your work may be a lifeline for them.  If I hadn't seen on Gerd's 
brian> site that someone (you) had gotten a version of findlib working on 
brian> Win32, I might not have pursued the matter as far as I did and may never 
brian> have gotten this sorted out.

I'm glad to hear you have solved the problem.


In depth, my patch to the findlib 0.8.1 has three (almost) independent
functionality:

 1) To allow spaces in names of install directories
       (patch to configure script)
 2) To allow spaces in command line invoked by ocamlfind
       (patch to a ML source file)
 3) To convert /cygdrive/... style pathname back to c:\ style,
    and some other issues with cygwin commands
       (patch to configure script)

So, as long as you use the path-name with no spaces (like "c:\ocaml3.0.7"),
You only need functionality 3), which is almost same as one suggested by
Eugene Kotlyarov.

# I have installed OCaml/mingw to "C:\Program Files\Objective Caml", so
# I needed functionalities 1) and 2).

The issue 1) is (to some extent) common in Unix environment: adding
many double-quotes carefully into configure script might be a good thing
to do; I will consider sending this part of fix to Gerd Stolpmann.
On the other hand, the issue 2) is specific to mingw environment: in
some place between the OCaml standard library and Windows cmd.exe (?),
double quotes are parsed twice and a space in the name of install path
becomes a word-splitter. I'm not sure whether this is a OCaml's bug or
not (just a spec), and also not sure whether this is fixed.
I have not dug this issue deeply and just patched findlib as a workaround.

I'm happy if this information helps someone in the future...

-- 
Yutaka Oiwa              Yonezawa Lab., Dept. of Computer Science,
      Graduate School of Information Sci. & Tech., Univ. of Tokyo.
                    <oiwa@yl.is.s.u-tokyo.ac.jp>, <yutaka@oiwa.jp>
PGP fingerprint = C9 8D 5C B8 86 ED D8 07  EA 59 34 D8 F4 65 53 61

-------------------
To unsubscribe, mail caml-list-request@inria.fr Archives: http://caml.inria.fr
Bug reports: http://caml.inria.fr/bin/caml-bugs FAQ: http://caml.inria.fr/FAQ/
Beginner's list: http://groups.yahoo.com/group/ocaml_beginners

