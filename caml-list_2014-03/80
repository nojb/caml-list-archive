Return-Path: <normand@linux.vnet.ibm.com>
X-Original-To: caml-list@sympa.inria.fr
Delivered-To: caml-list@sympa.inria.fr
Received: from mail3-relais-sop.national.inria.fr (mail3-relais-sop.national.inria.fr [192.134.164.104])
	by sympa.inria.fr (Postfix) with ESMTPS id 713BC7F89E
	for <caml-list@sympa.inria.fr>; Thu, 20 Mar 2014 16:53:38 +0100 (CET)
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  normand@linux.vnet.ibm.com) identity=pra;
  client-ip=195.75.94.111;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="normand@linux.vnet.ibm.com";
  x-sender="normand@linux.vnet.ibm.com";
  x-conformance=sidf_compatible
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  normand@linux.vnet.ibm.com) identity=mailfrom;
  client-ip=195.75.94.111;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="normand@linux.vnet.ibm.com";
  x-sender="normand@linux.vnet.ibm.com";
  x-conformance=sidf_compatible
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  postmaster@e06smtp15.uk.ibm.com) identity=helo;
  client-ip=195.75.94.111;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="normand@linux.vnet.ibm.com";
  x-sender="postmaster@e06smtp15.uk.ibm.com";
  x-conformance=sidf_compatible
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: Aq0BAKIOK1PDS15vnGdsb2JhbABZg0HEPxYOAQEBAQEGDQkJFCiCZEA9FhgDAgECAVgIAQGHeAGdd7ILjwKEIgSPV4hwgTKFGo8S
X-IPAS-Result: Aq0BAKIOK1PDS15vnGdsb2JhbABZg0HEPxYOAQEBAQEGDQkJFCiCZEA9FhgDAgECAVgIAQGHeAGdd7ILjwKEIgSPV4hwgTKFGo8S
X-IronPort-AV: E=Sophos;i="4.97,695,1389740400"; 
   d="scan'208";a="53462721"
Received: from e06smtp15.uk.ibm.com ([195.75.94.111])
  by mail3-smtp-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES256-SHA; 20 Mar 2014 16:53:37 +0100
Received: from /spool/local
	by e06smtp15.uk.ibm.com with IBM ESMTP SMTP Gateway: Authorized Use Only! Violators will be prosecuted
	for <caml-list@inria.fr> from <normand@linux.vnet.ibm.com>;
	Thu, 20 Mar 2014 15:53:37 -0000
Received: from d06dlp02.portsmouth.uk.ibm.com (9.149.20.14)
	by e06smtp15.uk.ibm.com (192.168.101.145) with IBM ESMTP SMTP Gateway: Authorized Use Only! Violators will be prosecuted;
	Thu, 20 Mar 2014 15:53:35 -0000
Received: from b06cxnps3075.portsmouth.uk.ibm.com (d06relay10.portsmouth.uk.ibm.com [9.149.109.195])
	by d06dlp02.portsmouth.uk.ibm.com (Postfix) with ESMTP id A8CAA219005C
	for <caml-list@inria.fr>; Thu, 20 Mar 2014 15:53:29 +0000 (GMT)
Received: from d06av02.portsmouth.uk.ibm.com (d06av02.portsmouth.uk.ibm.com [9.149.37.228])
	by b06cxnps3075.portsmouth.uk.ibm.com (8.13.8/8.13.8/NCO v10.0) with ESMTP id s2KFrMJS62193700
	for <caml-list@inria.fr>; Thu, 20 Mar 2014 15:53:22 GMT
Received: from d06av02.portsmouth.uk.ibm.com (localhost [127.0.0.1])
	by d06av02.portsmouth.uk.ibm.com (8.14.4/8.14.4/NCO v10.0 AVout) with ESMTP id s2KFrYSC006812
	for <caml-list@inria.fr>; Thu, 20 Mar 2014 09:53:34 -0600
Received: from [9.145.82.228] (sig-9-145-82-228.uk.ibm.com [9.145.82.228])
	by d06av02.portsmouth.uk.ibm.com (8.14.4/8.14.4/NCO v10.0 AVin) with ESMTP id s2KFrXbn006770
	for <caml-list@inria.fr>; Thu, 20 Mar 2014 09:53:33 -0600
Message-ID: <532B0EFD.9070606@linux.vnet.ibm.com>
Date: Thu, 20 Mar 2014 16:53:33 +0100
From: Normand <normand@linux.vnet.ibm.com>
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:24.0) Gecko/20100101 Thunderbird/24.3.0
MIME-Version: 1.0
To: caml-list@inria.fr
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-TM-AS-MML: disable
X-Content-Scanned: Fidelis XPS MAILER
x-cbid: 14032015-0342-0000-0000-0000082D1B19
Subject: [Caml-list] need help to investigate an ocaml build error on
 ppc64le archi

Hello there,
I am trying to investigate a failure while porting ocaml on ppc64le archi (flag1)
This is most probably related to some changes I did not made yet.
But because I do not understand anything about ocaml I do not know where to search.

I understand that the bad unix.o is generated by the call to ocamlcompopt.sh
calling itself ocamlrun with the parameters of flag2.

But I do not understand what archi specific files are used by this command line.

I would appreciate any suggestion on the subject.

flag1: the original failure log extract.
===
make[2]: Entering directory `/home/michel/rpmbuild/BUILD/ocaml-4.01.0/otherlibs/unix'
../../ocamlcompopt.sh -c -w +33..39 -warn-error A -g -nolabels unix.ml
../../ocamlcompopt.sh -c -w +33..39 -warn-error A -g -nolabels unixLabels.ml
../../boot/ocamlrun ../../tools/ocamlmklib -o unix -oc unix -ocamlopt '../../ocamlcompopt.sh' -linkall \
           unix.cmx unixLabels.cmx
../../ocamlcompopt.sh -shared -o unix.cmxs -I . unix.cmxa
/usr/bin/ld: unix.cmxs.startup.o: ABI version 1 is not compatible with ABI version 2 output
/usr/bin/ld: failed to merge target specific data of file unix.cmxs.startup.o
/usr/bin/ld: unix.a(unix.o): ABI version 1 is not compatible with ABI version 2 output
/usr/bin/ld: failed to merge target specific data of file unix.a(unix.o)
/usr/bin/ld: unix.a(unixLabels.o): ABI version 1 is not compatible with ABI version 2 output
/usr/bin/ld: failed to merge target specific data of file unix.a(unixLabels.o)
collect2: error: ld returned 1 exit status
===

flag2: unix.o generated from unix.ml
===
+ exec ../../boot/ocamlrun ../../ocamlopt -nostdlib -I ../../stdlib -c -w +33..39 -warn-error A -g -nolabels unix.ml
===
$file unix.ml
unix.ml: Mathematica 3.0 notebook
===
$readelf -h unix.o |grep Flags
    Flags:                             0x0
===

no full log because too big for attachment in ML

-- 
Michel Normand

