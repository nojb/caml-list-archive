Return-Path: <SRS0=x67x=G5=m4x.org=simon.cruanes.2007@bounces.m4x.org>
X-Original-To: caml-list@sympa.inria.fr
Delivered-To: caml-list@sympa.inria.fr
Received: from mail3-relais-sop.national.inria.fr (mail3-relais-sop.national.inria.fr [192.134.164.104])
	by sympa.inria.fr (Postfix) with ESMTPS id 53BA77EEBF
	for <caml-list@sympa.inria.fr>; Fri, 19 Jun 2015 14:08:58 +0200 (CEST)
Received-SPF: Neutral (mail3-smtp-sop.national.inria.fr: domain
  of simon.cruanes.2007@m4x.org does not assert whether or not
  129.104.30.34 is permitted sender) identity=pra;
  client-ip=129.104.30.34;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="SRS0=x67x=G5=m4x.org=simon.cruanes.2007@bounces.m4x.org";
  x-sender="simon.cruanes.2007@m4x.org";
  x-conformance=sidf_compatible; x-record-type="spf2.0"
Received-SPF: Pass (mail3-smtp-sop.national.inria.fr: domain of
  SRS0=x67x=G5=m4x.org=simon.cruanes.2007@bounces.m4x.org
  designates 129.104.30.34 as permitted sender)
  identity=mailfrom; client-ip=129.104.30.34;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="SRS0=x67x=G5=m4x.org=simon.cruanes.2007@bounces.m4x.org";
  x-sender="SRS0=x67x=G5=m4x.org=simon.cruanes.2007@bounces.m4x.org";
  x-conformance=sidf_compatible; x-record-type="spf2.0"
Received-SPF: Pass (mail3-smtp-sop.national.inria.fr: domain of
  postmaster@mx1.polytechnique.org designates 129.104.30.34 as
  permitted sender) identity=helo; client-ip=129.104.30.34;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="SRS0=x67x=G5=m4x.org=simon.cruanes.2007@bounces.m4x.org";
  x-sender="postmaster@mx1.polytechnique.org";
  x-conformance=sidf_compatible; x-record-type="v=spf1"
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: A0AvAQCEBYRVnCIeaIFCGoNkXwGDHbxShzpMAQEBAQEBEgEBAQEBBg0JCSEuhCMBBAEjVhALISECAg8FSYg6CA06rXOWf4tFh3WBQwWTegKEVoZ3gXyWM4IxHIFUbQGCRwEBAQ
X-IPAS-Result: A0AvAQCEBYRVnCIeaIFCGoNkXwGDHbxShzpMAQEBAQEBEgEBAQEBBg0JCSEuhCMBBAEjVhALISECAg8FSYg6CA06rXOWf4tFh3WBQwWTegKEVoZ3gXyWM4IxHIFUbQGCRwEBAQ
X-IronPort-AV: E=Sophos;i="5.13,643,1427752800"; 
   d="asc'?scan'208";a="137006776"
Received: from mx1.polytechnique.org ([129.104.30.34])
  by mail3-smtp-sop.national.inria.fr with ESMTP/TLS/ADH-AES256-SHA; 19 Jun 2015 14:08:57 +0200
Received: from emmental.inria.fr (emmental.inria.fr [128.93.0.14])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by ssl.polytechnique.org (Postfix) with ESMTPSA id 0E2C714091321;
	Fri, 19 Jun 2015 14:08:57 +0200 (CEST)
Date: Fri, 19 Jun 2015 14:08:05 +0200
From: Simon Cruanes <simon.cruanes.2007@m4x.org>
To: Gabriel Scherer <gabriel.scherer@gmail.com>
Cc: Damien Doligez <damien.doligez@inria.fr>,
	caml users <caml-list@inria.fr>
Message-ID: <20150619120805.GV32363@emmental.inria.fr>
References: <CALGm1VjzrTxSyVWWa_=G5u+ZXJeF-_aW9fv9Hx7J8Chu8h4_XA@mail.gmail.com>
 <20150619113820.GU32363@emmental.inria.fr>
 <CAPFanBGbg0qmyUASH_B+uEaOTQni5Qu1tiMKC=OtSEpC9w6NnQ@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha256;
	protocol="application/pgp-signature"; boundary="HENu/cXyPKFN4XCQ"
Content-Disposition: inline
In-Reply-To: <CAPFanBGbg0qmyUASH_B+uEaOTQni5Qu1tiMKC=OtSEpC9w6NnQ@mail.gmail.com>
User-Agent: Mutt/1.5.23.1-rc1 (2014-03-12)
X-AV-Checked: ClamAV using ClamSMTP at svoboda.polytechnique.org (Fri Jun 19 14:08:57 2015 +0200 (CEST))
X-Spam-Flag: No, tests=bogofilter, spamicity=0.000000, queueID=3894214091323
X-Org-Mail: simon.cruanes.2007@polytechnique.org
Subject: Re: [Caml-list] OCaml release 4.02.2


--HENu/cXyPKFN4XCQ
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Le Fri, 19 Jun 2015, Gabriel Scherer a =C3=A9crit :
> This change to the placement of attributes that was discussed in
>   http://caml.inria.fr/mantis/view.php?id=3D6612
>   https://github.com/ocaml/ocaml/pull/152
>=20
> It is indeed a mistake that it is not in the Changelog. As a meta-comment
> (not discussing this particular patch), in the future we might need to ha=
ve
> "a proper Changelog line" as an explicit requirement for all submitted
> patches (I would be tempted to add "a testsuite test exercising the
> affected features"), because it is fairly error-prone to try to track
> changes to add to the changelog after they've been merged.
>=20
> The rationale for this change is that the syntax was perceived as an
> improvement by the ppx-users that expressed an opinion on the issue, and
> they asked for this to be released as soon as possible hoping to facilita=
te
> the transition to the new syntax (few existing users).
> The change was tested against all released OPAM packages, and riak_ppx was
> the only package that broke. It seems that either (1) the code using the
> old syntax had not been released as OPAM packages yet (in retrospect it
> seems reasonable that using OPAM testing as only testing vehicle is rather
> fragile for very recent features; on the other hand, I don't know which
> other tests could be put in place) or (2) said packages did not break in a
> way that was perceptible to the automated tool.

ppx_deriving compiles with 4.02.2, but its tests do not pass. I indeed
have some unreleased code that breaks (it's on a distinct opam repo).
I suspect the tool does not run tests?

The syntax change might be an improvement indeed, but disabling the old beh=
avior
(attaching attributes to record labels) is *breaking* in a way that
makes fixes difficult. For instance, introducing 'nonrec' is breaking,
but in an easy to fix way; the attribute change is hard (you need to
edit code manually to move annotations).

>=20
> I think 4.02.2 is a slightly less minor release than is usual: it does ha=
ve
> some new features that are not simply bugfixes, because they were request=
ed
> by users which were eager to see them released (typically all the
> ppx-related changes). This is a delicate compromise to make, and
> unfortunately there are indeed a couple regressions -- despite a very
> silent rc1-to-release period. The only other one I know of is
> http://caml.inria.fr/mantis/view.php?id=3D6908 .


--=20
Simon

http://weusepgp.info/
key 49AA62B6, fingerprint 949F EB87 8F06 59C6 D7D3  7D8D 4AC0 1D08 49AA 62B6

--HENu/cXyPKFN4XCQ
Content-Type: application/pgp-signature; name="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJVhAYhAAoJEErAHQhJqmK2/JMP/0qZL4zBkRsllkPh+QSQmjUC
34SvZqqsRpFECk63OvrdY+Y0acJKM4jFBkx7jPPDq6I3K0dkH11v/6EVPsByl1vB
at4CPQDJ3O59TRJDq2j9YAZ/1uAO6NPOlacWPWIp2MbGDmACQuQbllj9ZRl52MDD
jyeV1INdYTpzckBz7ysbecT4F04Iv+DU+Sz+zCeTj9w7k9oxk+HH6mlnu7Eodr6v
L168dVWfIHnDEwNmzQqkbUSc3Ugph+ZjiDYxfATAEhI2j0OCIs7LJRNPvludpYkw
7EpcY7iwMMhlk28DCHVTyHzggmUx8Shk1jUlIgmDGamZs2uxvj7gTTtkglPkStlT
/WZWSw40RhQG/C93WJticAo6DTudS0FhF6JiHuKXM2+SfJIdGtwqI/28gsdxXXEs
U88gFDuErsZFP1zLrY0H8nSb0oK0WO8zjzxx18YYEIw8t13O2FJyC6R7FvpyO6OA
T6MFsV/+XHYqmUH9iy9graiUd0PnLqs6aLx3IVKyp7IguxcL8GeOLx593/xhT5lv
+snEE5WFtP2LXPrHoRcNffQckDyCUIBMuwj3pyRudlKKBlnmE2OP8FIdRW6oNzq7
qLeYD3F1rOMNrl7Y3F8TKyuy91pI9nLoq2b3TnQZv1luXdzYF/i11WrwpTuLaQmr
/b+iKmaZNbcOXVtAVM6j
=b9ar
-----END PGP SIGNATURE-----

--HENu/cXyPKFN4XCQ--

