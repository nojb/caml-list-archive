Received: (from majordomo@localhost) by pauillac.inria.fr (8.7.6/8.7.3) id UAA01432; Tue, 30 Apr 2002 20:03:39 +0200 (MET DST)
X-Authentication-Warning: pauillac.inria.fr: majordomo set sender to owner-caml-list@pauillac.inria.fr using -f
Received: from concorde.inria.fr (concorde.inria.fr [192.93.2.39]) by pauillac.inria.fr (8.7.6/8.7.3) with ESMTP id UAA01421 for <caml-list@pauillac.inria.fr>; Tue, 30 Apr 2002 20:03:38 +0200 (MET DST)
Received: from dpt-info.u-strasbg.fr (dpt-info.u-strasbg.fr [130.79.44.193])
	by concorde.inria.fr (8.11.1/8.11.1) with ESMTP id g3UI3b520987;
	Tue, 30 Apr 2002 20:03:37 +0200 (MET DST)
Received: (from luther@localhost)
	by dpt-info.u-strasbg.fr (8.9.3/8.9.3) id UAA16925;
	Tue, 30 Apr 2002 20:04:05 +0200
Date: Tue, 30 Apr 2002 20:04:05 +0200
From: Sven <luther@dpt-info.u-strasbg.fr>
To: Vitaly Lugovsky <vsl@ontil.ihep.su>
Cc: Xavier Leroy <xavier.leroy@inria.fr>, caml-list@inria.fr
Subject: Re: [Caml-list] OCaml packaging problems
Message-ID: <20020430200405.A16880@dpt-info.u-strasbg.fr>
References: <20020430111657.A18782@pauillac.inria.fr> <Pine.LNX.4.33.0204301720320.27777-100000@ontil.ihep.su>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 1.0.1i
In-Reply-To: <Pine.LNX.4.33.0204301720320.27777-100000@ontil.ihep.su>; from vsl@ontil.ihep.su on Tue, Apr 30, 2002 at 05:28:38PM +0400
Sender: owner-caml-list@pauillac.inria.fr
Precedence: bulk

On Tue, Apr 30, 2002 at 05:28:38PM +0400, Vitaly Lugovsky wrote:
> 
>  Hi!
> 
>  I'm having a big troubles packaging OCaml and 3rd party
> libraries (like lablGL, lablgtk) in RPM. All the evil is in 
> the ld.conf file - foreign libraries should add lines in 
> it at the installation.

Have a look at the debian package and the solution we have adopted there.

Basically there are now 3 different files :

/usr/lib/ocaml/ld.conf (the normal one) which is autogenerated by ocaml-ldconf
from the two other ones.

/etc/ocaml/ld.conf which can be filled by the administrator to override the
dpkg generated one. (it has per line, a directory, and the command word
add/addafter/remove).

/var/lib/ocaml/ld.conf which is filled by a special prerm/postinst script, and
contains, not only the directory to add to ld.conf, but also the package
where this path originate. a package can provide more than one such path.

It works rather nicely, altough the ocaml-ldconf program could use some
enhancement (i wrote it hastily, but it does the job and was further
fool-tested during the debian testing process).

If this seems agreable to you, feel free to reuse any part of this scheme (the
ocaml-ldconf.ml file is GPLed though, there is a basic manpage i think, and i
don't think the debhelper scripts would be usefull in a rpm context).

I also needed to add a small patch to ocam lso it will not accept comment in
the ld.conf file, but apart form that, no changes were needed.

If more people like this scheme, it could even be considered for upstream
adoption.

>  The much better approach to the multi-package configurations
> is introduced, e.g. in xinetd, new crontabs, and so on - all
> external packages writes their configuration files or even
> just a symlinks to the special directory. So, it'll be better to
> have a special directory like ld.conf.dir/ with symlinks to
> the actual dynamic library paths, which will be updated safely
> when new packages are installed/removed. But, we've no directory

That would be another solution, 

Friendly,

Sven Luther
-------------------
To unsubscribe, mail caml-list-request@inria.fr Archives: http://caml.inria.fr
Bug reports: http://caml.inria.fr/bin/caml-bugs FAQ: http://caml.inria.fr/FAQ/
Beginner's list: http://groups.yahoo.com/group/ocaml_beginners

