Return-Path: <psnively@mac.com>
X-Original-To: caml-list@sympa.inria.fr
Delivered-To: caml-list@sympa.inria.fr
Received: from mail3-relais-sop.national.inria.fr (mail3-relais-sop.national.inria.fr [192.134.164.104])
	by sympa.inria.fr (Postfix) with ESMTPS id 427DC7EE34
	for <caml-list@sympa.inria.fr>; Mon, 28 Mar 2016 15:39:48 +0200 (CEST)
IronPort-PHdr: 9a23:pJTKLh1DiJQbb6hismDT+DRfVm0co7zxezQtwd8ZsegVKfad9pjvdHbS+e9qxAeQG96Lu7Qe16GI7+jJYi8p39WoiDg6aptCVhsI2409vjcLJ4q7M3D9N+PgdCcgHc5PBxdP9nC/NlVJSo6lPwWB6kO74TNaIBjjLw09fr2zQd6CyZ7rnL7us7ToICx2xxOFKYtoKxu3qQiD/uI3uqBFbpgL9x3Sv3FTcP5Xz247bXianhL7+9vitMU7q3cY6Lod8JtLWKD+OqA5VqBwDTI8Mmlz6te4mwPESF6372YYGl4QkwRFBxmNuAnhWJbvvy/rnu9002+ROsigHuN8Yiir86o+EEygsywALTNsqGw=
Authentication-Results: mail3-smtp-sop.national.inria.fr; spf=None smtp.pra=psnively@mac.com; spf=Pass smtp.mailfrom=psnively@mac.com; spf=None smtp.helo=postmaster@st13p15im-asmtp004.me.com
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  psnively@mac.com) identity=pra; client-ip=17.164.72.58;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="psnively@mac.com";
  x-sender="psnively@mac.com"; x-conformance=sidf_compatible
Received-SPF: Pass (mail3-smtp-sop.national.inria.fr: domain of
  psnively@mac.com designates 17.164.72.58 as permitted sender)
  identity=mailfrom; client-ip=17.164.72.58;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="psnively@mac.com";
  x-sender="psnively@mac.com"; x-conformance=sidf_compatible;
  x-record-type="v=spf1"
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  postmaster@st13p15im-asmtp004.me.com) identity=helo;
  client-ip=17.164.72.58;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="psnively@mac.com";
  x-sender="postmaster@st13p15im-asmtp004.me.com";
  x-conformance=sidf_compatible
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: A0CLAQBUM/lWkzpIpBFbhAF9qE4EA5QbFwELhWqBIjwQAQEBAQEBAQEQAQEBAQcNCQkhL4Itgi0RGlsBKBUCgRSHbwEVAwugFIFKAY4SilYRhRcBAQEYBIYegXMIhSSCDhINgXwLLRMYgisFh16GUj6Ic4VxiXuHdIUxjws3gj+BcUwBAYhUAQEB
X-IPAS-Result: A0CLAQBUM/lWkzpIpBFbhAF9qE4EA5QbFwELhWqBIjwQAQEBAQEBAQEQAQEBAQcNCQkhL4Itgi0RGlsBKBUCgRSHbwEVAwugFIFKAY4SilYRhRcBAQEYBIYegXMIhSSCDhINgXwLLRMYgisFh16GUj6Ic4VxiXuHdIUxjws3gj+BcUwBAYhUAQEB
X-IronPort-AV: E=Sophos;i="5.24,406,1454972400"; 
   d="scan'208,217";a="171253638"
Received: from st13p15im-asmtp004.me.com ([17.164.72.58])
  by mail3-smtp-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES128-GCM-SHA256; 28 Mar 2016 15:39:47 +0200
Received: from valhalla.fios-router.home
 (pool-108-23-73-105.lsanca.fios.verizon.net [108.23.73.105])
 by st13p15im-asmtp004.me.com
 (Oracle Communications Messaging Server 7.0.5.36.0 64bit (built Sep  8 2015))
 with ESMTPSA id <0O4R01C5A4M8EF00@st13p15im-asmtp004.me.com> for
 caml-list@inria.fr; Mon, 28 Mar 2016 13:39:45 +0000 (GMT)
X-Proofpoint-Virus-Version: vendor=fsecure engine=2.50.10432:,,
 definitions=2016-03-28_10:,, signatures=0
X-Proofpoint-Spam-Details: rule=notspam policy=default score=0 spamscore=0
 clxscore=1015 suspectscore=3 malwarescore=0 phishscore=0 adultscore=0
 bulkscore=0 classifier=spam adjust=0 reason=mlx scancount=1
 engine=8.0.1-1510270003 definitions=main-1603280214
From: Paul Snively <psnively@mac.com>
Content-type: multipart/alternative;
 boundary="Apple-Mail=_04B2B616-4359-4A0D-A5F3-E5F9652C1D74"
Message-id: <206FE738-9D7C-4739-A82B-643CFF82260B@mac.com>
Date: Mon, 28 Mar 2016 06:39:44 -0700
To: caml-list@inria.fr
MIME-version: 1.0 (Mac OS X Mail 9.3 \(3124\))
X-Mailer: Apple Mail (2.3124)
Subject: [Caml-list] Oasis Bug?


--Apple-Mail=_04B2B616-4359-4A0D-A5F3-E5F9652C1D74
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=utf-8

Hi everyone,

I recently tried installing some packages in OPAM using the ocaml-4.02.3-mu=
sl-static compiler. One of them failed because it includes some C stubs, an=
d the build script, which was generated by Oasis, blithely assumed dynlink =
support. After a bit of digging, I found this <https://github.com/ocaml/oas=
is/blob/0.4.5/src/oasis/OASISLibrary.ml#L203> line. This seems to be in err=
or to me. Shouldn=E2=80=99t the line read:

if has_native_dynlink [["dll"^cs.cs_name^"_stubs"^ext_dll]] else []

to account for the possibility that the compiler cannot generate or load dy=
namic libraries?

In any event, even if I=E2=80=99m wrong about the particulars, it=E2=80=99s=
 clearly true that the ocamlbuild code generated by at least some versions =
of Oasis does not respect the inability of perfectly valid OCaml environmen=
ts to support shared libraries, so any advice is welcome.

Best regards,
Paul=

--Apple-Mail=_04B2B616-4359-4A0D-A5F3-E5F9652C1D74
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html;
	charset=utf-8

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html charset=
=3Dutf-8"></head><body style=3D"word-wrap: break-word; -webkit-nbsp-mode: s=
pace; -webkit-line-break: after-white-space;" class=3D"">Hi everyone,<div c=
lass=3D""><br class=3D""></div><div class=3D"">I recently tried installing =
some packages in OPAM using the ocaml-4.02.3-musl-static compiler. One of t=
hem failed because it includes some C stubs, and the build script, which wa=
s generated by Oasis, blithely assumed dynlink support. After a bit of digg=
ing, I found&nbsp;<a href=3D"https://github.com/ocaml/oasis/blob/0.4.5/src/=
oasis/OASISLibrary.ml#L203" class=3D"">this</a>&nbsp;line. This seems to be=
 in error to me. Shouldn=E2=80=99t the line read:</div><div class=3D""><br =
class=3D""></div><div class=3D""><font face=3D"PT Mono" class=3D"">if has_n=
ative_dynlink [["dll"^cs.cs_name^"_stubs"^ext_dll]] else []</font></div><di=
v class=3D""><br class=3D""></div><div class=3D"">to account for the possib=
ility that the compiler cannot generate or load dynamic libraries?</div><di=
v class=3D""><br class=3D""></div><div class=3D"">In any event, even if I=
=E2=80=99m wrong about the particulars, it=E2=80=99s clearly true that the =
ocamlbuild code generated by at least some versions of Oasis does not respe=
ct the inability of perfectly valid OCaml environments to support shared li=
braries, so any advice is welcome.</div><div class=3D""><br class=3D""></di=
v><div class=3D"">Best regards,</div><div class=3D"">Paul</div></body></htm=
l>=

--Apple-Mail=_04B2B616-4359-4A0D-A5F3-E5F9652C1D74--
