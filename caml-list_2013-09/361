Return-Path: <yotambarnoy@gmail.com>
X-Original-To: caml-list@sympa.inria.fr
Delivered-To: caml-list@sympa.inria.fr
Received: from mail2-relais-roc.national.inria.fr (mail2-relais-roc.national.inria.fr [192.134.164.83])
	by sympa.inria.fr (Postfix) with ESMTPS id D91857EE4B
	for <caml-list@sympa.inria.fr>; Fri, 27 Sep 2013 17:38:08 +0200 (CEST)
Received-SPF: None (mail2-smtp-roc.national.inria.fr: no sender
  authenticity information available from domain of
  yotambarnoy@gmail.com) identity=pra;
  client-ip=209.85.216.170;
  receiver=mail2-smtp-roc.national.inria.fr;
  envelope-from="yotambarnoy@gmail.com";
  x-sender="yotambarnoy@gmail.com";
  x-conformance=sidf_compatible
Received-SPF: Pass (mail2-smtp-roc.national.inria.fr: domain of
  yotambarnoy@gmail.com designates 209.85.216.170 as permitted
  sender) identity=mailfrom; client-ip=209.85.216.170;
  receiver=mail2-smtp-roc.national.inria.fr;
  envelope-from="yotambarnoy@gmail.com";
  x-sender="yotambarnoy@gmail.com";
  x-conformance=sidf_compatible; x-record-type="v=spf1"
Received-SPF: None (mail2-smtp-roc.national.inria.fr: no sender
  authenticity information available from domain of
  postmaster@mail-qc0-f170.google.com) identity=helo;
  client-ip=209.85.216.170;
  receiver=mail2-smtp-roc.national.inria.fr;
  envelope-from="yotambarnoy@gmail.com";
  x-sender="postmaster@mail-qc0-f170.google.com";
  x-conformance=sidf_compatible
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: Ai0CAHmlRVLRVdiqm2dsb2JhbABahBHAS4EUCBYOAQEBAQEGCwsJFCiCJQEBBAFAARsdAQMMBgUEBzshAQERAQUBHAYTh3MBAwkGnAiMUoMKhAsKGScNZIkAAQUMjFqBLYE+B4QgA5YWgWmMRINKGCmEaSCBLQ
X-IPAS-Result: Ai0CAHmlRVLRVdiqm2dsb2JhbABahBHAS4EUCBYOAQEBAQEGCwsJFCiCJQEBBAFAARsdAQMMBgUEBzshAQERAQUBHAYTh3MBAwkGnAiMUoMKhAsKGScNZIkAAQUMjFqBLYE+B4QgA5YWgWmMRINKGCmEaSCBLQ
X-IronPort-AV: E=Sophos;i="4.90,994,1371074400"; 
   d="scan'208";a="34649852"
Received: from mail-qc0-f170.google.com ([209.85.216.170])
  by mail2-smtp-roc.national.inria.fr with ESMTP/TLS/RC4-SHA; 27 Sep 2013 17:38:02 +0200
Received: by mail-qc0-f170.google.com with SMTP id m20so1862806qcx.1
        for <caml-list@inria.fr>; Fri, 27 Sep 2013 08:38:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :cc:content-type;
        bh=xdlPOMJTXC+qFY0RZ1qh/JTp/zlFEY90xsxYA43CraU=;
        b=nQRd/Of9sNyO4+2fRSuyHFaS0ro8PpxPeNXURZo5rvjinQTeZHUs220Xbczv+nFzvk
         hgt4RftwcJYc+U1RmUpOxhfQpwro3FVfOhL7UJA35Xoi/puDU/NBvSnPpU5KzT+A4nOt
         i7HvU9HO4sFH36CuCUqWIOOQG4ldbOWLQLFLWmnrsPQZEH8cZoqK5wPjhWBVhRUpkMPf
         e8hOwNHeQdfWOfhW5re85OIOwopQeGav3ndWHMYl+z2+3bU9kWrzTymwE2QE5nJx6LF/
         VD3MXsVS4aQh9rjD0A0Y2hr2A5sGx2jivYIj3lPtJgkcuxsGuxbnnkR11xW4XOEx7WMk
         vB8A==
X-Received: by 10.49.131.132 with SMTP id om4mr9939356qeb.2.1380296282323;
 Fri, 27 Sep 2013 08:38:02 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.224.139.20 with HTTP; Fri, 27 Sep 2013 08:37:42 -0700 (PDT)
In-Reply-To: <CAN=ouMRpbwSZqi_b07TKRFvUSZNxtanM=J4+iws_d8m6LDFt3Q@mail.gmail.com>
References: <CAN6ygO=cnhc039DEOVf7uZqpTCedVO0SMnG+rvFw4hm4qPc7cg@mail.gmail.com>
 <CAPi0vKVcq4+qn_k0KnDUsMs1L495oWmeHoqPwJPMtEPYx=M-EA@mail.gmail.com> <CAN=ouMRpbwSZqi_b07TKRFvUSZNxtanM=J4+iws_d8m6LDFt3Q@mail.gmail.com>
From: Yotam Barnoy <yotambarnoy@gmail.com>
Date: Fri, 27 Sep 2013 11:37:42 -0400
Message-ID: <CAN6ygO=7wsXqD+g5X5nGH4fS3kb-tU9r4ZgA=85ESUSui8h3WA@mail.gmail.com>
To: Anthony Tavener <anthony.tavener@gmail.com>
Cc: Dmitry Grebeniuk <gdsfh1@gmail.com>, Yotam Barnoy <caml-list@inria.fr>
Content-Type: multipart/alternative; boundary=047d7beb9a4697c57904e75f45b7
Subject: Re: [Caml-list] Proposal: re-design of ocaml headers


--047d7beb9a4697c57904e75f45b7
Content-Type: text/plain; charset=ISO-8859-1

On Fri, Sep 27, 2013 at 11:31 AM, Anthony Tavener <anthony.tavener@gmail.com
> wrote:

>
> On Fri, Sep 27, 2013 at 9:08 AM, Dmitry Grebeniuk <gdsfh1@gmail.com>wrote:
>
>>
>>   Why will anyone ever need more than 200 constructors of a sum type?
>> (also note the presence of polymorphic variant types.)
>>
>>
> Back when I read about the limit on constructors I had a moment of worry.
> Thankfully the limit is only on non-constant constructors.
>
> I currently have a variant with 292 constructors, but only 30 are
> non-constant.
> These represent optional characteristics a character may have in a game,
> some
> with additional payload. I could imagine all of them having their own
> payload,
> but of course there are other options, like polymorphic variants, or
> encoding these
> purely as data rather than types.
>
> I wanted to share that as a "be careful of what seems impossible from your
> perspective". ;)
>

Right. Constant constructors are represented as integers and require no
header, so they're very cheap. And polymorphic variants use more memory, so
they're not a great option. Having the flexibility for more constructors is
a good thing.

Yotam

--047d7beb9a4697c57904e75f45b7
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On F=
ri, Sep 27, 2013 at 11:31 AM, Anthony Tavener <span dir=3D"ltr">&lt;<a href=
=3D"mailto:anthony.tavener@gmail.com" target=3D"_blank">anthony.tavener@gma=
il.com</a>&gt;</span> wrote:<br>

<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><div dir=3D"ltr"><br><div class=3D"gmail_ext=
ra"><div class=3D"gmail_quote"><div class=3D"im">On Fri, Sep 27, 2013 at 9:=
08 AM, Dmitry Grebeniuk <span dir=3D"ltr">&lt;<a href=3D"mailto:gdsfh1@gmai=
l.com" target=3D"_blank">gdsfh1@gmail.com</a>&gt;</span> wrote:<br>


<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><br>
=A0 Why will anyone ever need more than 200 constructors of a sum type?<br>
(also note the presence of polymorphic variant types.)<br>
<div><br></div></blockquote><div><br></div></div><div>Back when I read abou=
t the limit on constructors I had a moment of worry.</div><div>Thankfully t=
he limit is only on non-constant constructors.</div><div>
<br></div><div>I currently have a variant with 292 constructors, but only 3=
0 are non-constant.</div><div>These represent optional characteristics a ch=
aracter may have in a game, some</div><div>with additional payload. I could=
 imagine all of them having their own payload,</div>


<div>but of course there are other options, like polymorphic variants, or e=
ncoding these</div><div>purely as data rather than types.</div><div><br></d=
iv><div>I wanted to share that as a &quot;be careful of what seems impossib=
le from your</div>


<div>perspective&quot;. ;)=A0</div></div></div></div>
</blockquote></div><br></div><div class=3D"gmail_extra">Right. Constant con=
structors are represented as integers and require no header, so they&#39;re=
 very cheap. And polymorphic variants use more memory, so they&#39;re not a=
 great option. Having the flexibility for more constructors is a good thing=
.<br>

<br></div><div class=3D"gmail_extra">Yotam<br></div><div class=3D"gmail_ext=
ra"><br></div></div>

--047d7beb9a4697c57904e75f45b7--
