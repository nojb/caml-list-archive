Received: (from weis@localhost) by pauillac.inria.fr (8.7.6/8.7.3) id PAA10502 for caml-redistribution; Wed, 24 Mar 1999 15:32:08 +0100 (MET)
Received: from nez-perce.inria.fr (nez-perce.inria.fr [192.93.2.78]) by pauillac.inria.fr (8.7.6/8.7.3) with ESMTP id FAA14364 for <caml-list@pauillac.inria.fr>; Wed, 24 Mar 1999 05:20:34 +0100 (MET)
Received: from simon.cs.cornell.edu (SIMON.CS.CORNELL.EDU [128.84.154.10])
	by nez-perce.inria.fr (8.8.7/8.8.7) with ESMTP id FAA01193;
	Wed, 24 Mar 1999 05:20:32 +0100 (MET)
Received: from cloyd.cs.cornell.edu (CLOYD.CS.CORNELL.EDU [128.84.227.15])
	by simon.cs.cornell.edu (8.9.3/8.9.3/R-2.1) with ESMTP id XAA04162;
	Tue, 23 Mar 1999 23:20:30 -0500 (EST)
Received: from CS.Cornell.EDU (IDENT:nogin@GULAG.CS.CORNELL.EDU [128.84.248.53])
	by cloyd.cs.cornell.edu (8.9.3/8.9.3/M-2.0) with ESMTP id XAA17270;
	Tue, 23 Mar 1999 23:20:24 -0500 (EST)
Sender: weis
Message-ID: <36F86807.2F03B08@CS.Cornell.EDU>
Date: Tue, 23 Mar 1999 23:20:23 -0500
From: Alexey Nogin <nogin@cs.cornell.edu>
Organization: Cornell University, department of Computer Science
X-Mailer: Mozilla 4.08 [en] (X11; U; Linux 2.0.37 i686)
MIME-Version: 1.0
To: Anton Moscal <msk@post.tepkom.ru>
CC: Xavier Leroy <Xavier.Leroy@inria.fr>, caml-list@inria.fr,
        Jason Hickey <jyh@cs.cornell.edu>,
        Alexei Kopylov <kopylov@cs.cornell.edu>,
        Paul Stodghill <stodghil@cs.cornell.edu>
Subject: Re: Upgrade from OCaml 2.01 to OCaml 2.02 made things _slower_!
References: <Pine.LNX.4.03.9903131639010.7348-101000@post.tepkom.ru>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Anton Moscal wrote:

> > > pressure locally, causing other stuff to be spilled on the stack,
> > > though.
> >
> > Well, in this case I should probably try to remove the allocation coalescing
> > and see what happens. Am I right assuming that in order to do that I have to
> > revert changes for versions 1.8 -> 1.9 and 1.10 -> 1.11 of the
> > asmcomp/selectgen.ml?
> >
> Also you can try to apply this patch (attached to this message) to
> asmcomp/selectgen.ml: this is another variant of allocation combiner.
> Code, generated by this patch, is more close to code generated by the
> ocaml-2.01 than the code from official ocaml-2.02 (Warning: I tested it
> only on my own programs and on the Ocaml bootstrapping).

Thanks for the patch, but unfortunately it only made thinks even slower than with
2.02. It raised (compared with 2.02) number of memory requests by 0.2%-2% and
made L2 miss rate grow (up to from 37% to 44% on some input).

Alexey
--------------------------------------------------------------
Home Page: http://www.cs.cornell.edu/nogin/
E-Mail: nogin@cs.cornell.edu (office), ayn2@cornell.edu (home)
Office: Upson 4139, tel: 1-607-255-4934
ICQ #: 24708107 (office), 24678341 (home)




