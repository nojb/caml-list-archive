Return-Path: <Sebastien.Hinderer@ens-lyon.org>
X-Spam-Checker-Version: SpamAssassin 3.1.3 (2006-06-01) on yquem.inria.fr
X-Spam-Level: 
X-Spam-Status: No, score=0.0 required=5.0 tests=none autolearn=disabled 
	version=3.1.3
X-Original-To: caml-list@yquem.inria.fr
Delivered-To: caml-list@yquem.inria.fr
Received: from concorde.inria.fr (concorde.inria.fr [192.93.2.39])
	by yquem.inria.fr (Postfix) with ESMTP id 7423BBC0A
	for <caml-list@yquem.inria.fr>; Mon, 14 May 2007 09:06:11 +0200 (CEST)
Received: from relay-am.club-internet.fr (relay-am.club-internet.fr [194.158.104.67])
	by concorde.inria.fr (8.13.6/8.13.6) with ESMTP id l4E76BId021080
	for <caml-list@yquem.inria.fr>; Mon, 14 May 2007 09:06:11 +0200
Received: from Galois (4aa54-2-89-80-51-65.dsl.club-internet.fr [89.80.51.65])
	by relay-am.club-internet.fr (Postfix) with ESMTP id EA9C12560A
	for <caml-list@yquem.inria.fr>; Mon, 14 May 2007 09:06:10 +0200 (CEST)
Received: from evariste by Galois with local (Exim 4.67)
	(envelope-from <Sebastien.Hinderer@ens-lyon.org>)
	id 1HnUdF-00010n-7L
	for caml-list@yquem.inria.fr; Mon, 14 May 2007 09:06:10 +0200
Date: Mon, 14 May 2007 09:06:09 +0200
From: =?iso-8859-1?Q?S=E9bastien?= Hinderer <Sebastien.Hinderer@ens-lyon.org>
To: caml-list@yquem.inria.fr
Subject: Compiling a library with findlib
Message-ID: <20070514070609.GA3876@galois>
Mail-Followup-To: caml-list@yquem.inria.fr
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
X-Sarkowall: Nicolas Sarkozy, pour une France karsherisee, sans Pensee, sans Idees
X-Miltered: at concorde with ID 46480A63.000 by Joe's j-chkmail (http://j-chkmail . ensmp . fr)!
X-Spam: no; 0.00; ens-lyon:01 findlib:01 stubs:01 ocamlfind:01 lib:01 lib:01 mli:01 stubs:01 ocamlfind:01 ocamlmklib:01 cmxa:01 ocamlmklib:01 cmxa:01 cleanest:98 constants:01 

Dear all,

I am wondering what would be cleanest way of compiling a library
including C stubs using the ocamlfind program.

The library consists in the files lib.ml, lib.mli, lib_stubs.c and
constants.ml which is generated by awk scripts from C sources.

For the moment, the configure script detects wether ocamlfind is
installed or not. If it is not installed, ocamlmklib is used and
produces lib.cma, lib.cmxa, lib.a and lib.so which all seem to be
useful.

When ocamlfind is installed, though, I have no idea how to produce lib.a
and lib.so which seem to be necessary.
In particular, ocamlfind does not seem to have an interface to the
ocamlmklib connand.
So the questions I have are:

1. Is it necessary to compile/install the lib;a and lib.so files ?
2. How can these files be produced (in addition to the .cma and .cmxa
files) on a system where ocamlfindlib is installed ?

Thanks a lot for your help,
Sébastien.

