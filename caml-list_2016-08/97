Return-Path: <info@gerd-stolpmann.de>
X-Original-To: caml-list@sympa.inria.fr
Delivered-To: caml-list@sympa.inria.fr
Received: from mail3-relais-sop.national.inria.fr (mail3-relais-sop.national.inria.fr [192.134.164.104])
	by sympa.inria.fr (Postfix) with ESMTPS id DD1CE7F72C
	for <caml-list@sympa.inria.fr>; Tue, 16 Aug 2016 21:02:02 +0200 (CEST)
IronPort-PHdr: 9a23:wJZDEB3Xb3VPZFxAsmDT+DRfVm0co7zxezQtwd8ZsegfI/ad9pjvdHbS+e9qxAeQG96KsrQd1KGP6f+oGTRZp83Q6DZaKN0EfiRGoP1epxYnDs+BBB+zB9/RRAt+Iv5/UkR49WqwK0lfFZW2TVTTpnqv8WxaQU2nZkJLL+j4UrTfk96wn7jrvcaCOkMR23HkO+w6bE3v616A7o9O2coqA51y4yOBmmFPdeVSyDEgDnOotDG42P2N+oV++T9bofMr+p0Ie6z7e6MlUe4QV2x+YCgdrffmvhjbTAaJ+mBUEiBPykIJUED560TZV5T4vjay4ul02yCWIIv2RL49Xz2k5o9kTRbpjGEMMDtvo0/Njcklo69BrFqauxt724vdZofdYPt4cKT1ct4ASS9aQsFVTylIBIX6Y4ZZXLlJBvpRs4So/whGlhC5HwT5Qbq3kjI=
Authentication-Results: mail3-smtp-sop.national.inria.fr; spf=None smtp.pra=info@gerd-stolpmann.de; spf=None smtp.mailfrom=info@gerd-stolpmann.de; spf=None smtp.helo=postmaster@mout.kundenserver.de
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  info@gerd-stolpmann.de) identity=pra;
  client-ip=217.72.192.75;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="info@gerd-stolpmann.de";
  x-sender="info@gerd-stolpmann.de";
  x-conformance=sidf_compatible
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  info@gerd-stolpmann.de) identity=mailfrom;
  client-ip=217.72.192.75;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="info@gerd-stolpmann.de";
  x-sender="info@gerd-stolpmann.de";
  x-conformance=sidf_compatible
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  postmaster@mout.kundenserver.de) identity=helo;
  client-ip=217.72.192.75;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="info@gerd-stolpmann.de";
  x-sender="postmaster@mout.kundenserver.de";
  x-conformance=sidf_compatible
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: A0DWAACQYrNXh0vASNlEGoQZfLFWh3OBfSSFeQKBWToSAgEBAQEBAQEBEgEBAQgNCQkZL4IyBAETAYIUAQUnLiQQCxI0SQ4GEwkSiBoBCS2+IQEBAQEBAQQBAQEBFQ6FMoVFhCMBASeCPQuDBwWIKpEXgT0ChF+LNIcZhXOHOoR+g3glBoI7ARALgU5sAYUbDxcEgRsBAQE
X-IPAS-Result: A0DWAACQYrNXh0vASNlEGoQZfLFWh3OBfSSFeQKBWToSAgEBAQEBAQEBEgEBAQgNCQkZL4IyBAETAYIUAQUnLiQQCxI0SQ4GEwkSiBoBCS2+IQEBAQEBAQQBAQEBFQ6FMoVFhCMBASeCPQuDBwWIKpEXgT0ChF+LNIcZhXOHOoR+g3glBoI7ARALgU5sAYUbDxcEgRsBAQE
X-IronPort-AV: E=Sophos;i="5.28,529,1464645600"; 
   d="asc'?scan'208";a="190160079"
Received: from mout.kundenserver.de ([217.72.192.75])
  by mail3-smtp-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 16 Aug 2016 21:02:01 +0200
Received: from office1.lan.sumadev.de ([89.14.11.95]) by
 mrelayeu.kundenserver.de (mreue103) with ESMTPSA (Nemesis) id
 0MB1l6-1bS0NX38js-00A00R; Tue, 16 Aug 2016 21:01:59 +0200
Received: from e130 (unknown [192.168.65.10])
	by office1.lan.sumadev.de (Postfix) with ESMTPSA id 048FDDC05D;
	Tue, 16 Aug 2016 21:01:58 +0200 (CEST)
Message-ID: <1471374103.14938.3.camel@gerd-stolpmann.de>
From: Gerd Stolpmann <info@gerd-stolpmann.de>
To: Kakadu <kakadu.hafanana@gmail.com>
Cc: Caml List <caml-list@inria.fr>
Date: Tue, 16 Aug 2016 21:01:43 +0200
In-Reply-To: <CAGmVoG0PChOr8brCm0W+OouUuEWUKBuFk9iX1XZhujcyAA+Cvg@mail.gmail.com>
References: 
	<CAGmVoG0PChOr8brCm0W+OouUuEWUKBuFk9iX1XZhujcyAA+Cvg@mail.gmail.com>
Content-Type: multipart/signed; micalg="pgp-sha256";
	protocol="application/pgp-signature"; boundary="=-jsLQJE5laCGZc2+aKZpK"
X-Mailer: Evolution 3.18.5.2-0ubuntu3 
Mime-Version: 1.0
X-Provags-ID: V03:K0:ooBhKMvboyyl8x4s5gMjwHQRHbAq5BU+95/GObwsDd8Tq1OjemX
 RAUnPtq5R1Ct9YSkKdX6jhmG79E1fuW1cXYKeXqV/1/yDCdXeFL5URf0CSQEREfH7gvPdcm
 IURwD7ghwmiJnEa00IujyzsiIclBc5jJ43pclgRa6TlhfBmhy3DXaVWX+dSh2bcwjGywTXF
 jzew6fbEHJAtDFcF5ajtw==
X-UI-Out-Filterresults: notjunk:1;V01:K0:P0kqV9h57PU=:HZdFmK5sbEp3Q8KbnFw8c8
 LzK/ApF2YYHqLmoI8QrQWCDmGsreT/1wbrrph3KNqGtIe9gq4W8EpO4cHz6/2aHp+EAvW4NaI
 E1QOX+vnnJatcx1tYZdAzQ4PSiGY4ke6Y2M/MQjwONmlMqJLxsUpE+Xnh3J8anKw6dfBaWzaQ
 vhIeixQvOB3jPUpjAd3YNW/S0zJlsGllpbBUEXTYgPX0k1sd4p7QqzBbkckpQasuhng1wlx4N
 vel6IvfEJ7/IDaLGxrqS27f25B18JPFe7a+Vjm2qx4hO1xYWcv0pJuRGsJKxV/AYQSscZbE0X
 y39jRe5suSoXQNcl40VQrb0GDrWsBE6/9R0HemT6CDXw7UgRNUINnFrRZs9JGkrbCFrAh6dBR
 W6S5LHlvh5hyrRK9y+40QGDYFNd7dQons45wLLLlHoyQiyv4KIw0vVNxY/BCuUNRloiH4c+II
 5ivkZBEAF4EevSQgmIlshR/sQNHAbmgxjmR+KSz5ndOlsqkD8SxnuplLatFTeFEacVKLF4y2R
 FjnXM6T9KzfkurB2z8n1QnGSM9GGZtYE9B2To4RYr+k9aqlTmJKZzSCx68eSDJEN4mg3wFAuN
 bAOb3i+z/S56UrpRMRhVKNs7wzG/I/49cM4DS9rOOv1OpBbknukgUFcsywXQ9mf+h+iXOB0pp
 APObuq/l7ZFPBwoQFXYDXaBQqKlPXEDzptSJf0VtyBPrScmyT9KC1CNZL3P1VJ3639wY=
Subject: Re: [Caml-list] Annoying warning about double installation of
 topdirs.cmi


--=-jsLQJE5laCGZc2+aKZpK
Content-Type: text/plain; charset="ISO-8859-15"
Content-Transfer-Encoding: quoted-printable

See also this older bug:=A0http://caml.inria.fr/mantis/view.php?id=3D5628

For all OCaml versions where #remove_directory is available, findlib
now temporarily adds compiler-libs to the path while initializing
itself for the toploop, and removes the compiler-libs directory
afterwards. So at least findlib isn't dependent on having topdirs.cmi
still in the main stdlib directory.

I don't know for other users of topdirs.

Gerd

Am Dienstag, den 16.08.2016, 16:04 +0300 schrieb Kakadu:
> Hey,
>=20
> After introducing compiler-libs we have starting getting a warning
> when we use compiler-libs as ocamlfind package.
>=20
> findlib: [WARNING] Interface topdirs.cmi occurs in several
> directories: /home/kakadu/.opam2/4.02.3/lib/ocaml,
> /home/kakadu/.opam2/4.02.3/lib/ocaml/compiler-libs
>=20
> (* It has its own mantis issue [1] where gasche have said that we
> should discuss it in the mail list before fixing it. *)
>=20
> It happens because we install topdirs.cmi both to `ocamlc -where` and
> `ocamlc -where`/compiler-libs. Of course these are identical files
> with the same size and MD5 checksum.
>=20
> The obvious choice should be not installing this file to `ocamlc
> -where` (I) or to `ocamlc -where`/compiler-libs (II).
>=20
> (I) Seems to be the right solution architecture-wise but it can
> introduce backward-incompatibility in OPAM: after initialization it
> puts some code into ~/.ocamlinit which relies on topdirs.cmi [2].
> Personally, I removed this line from my ~/.ocamlinit because it seems
> useless for my case. So, by removing `topdirs.cmi` from `ocamlc
> -where` we should probably release bugfix release for opam.
>=20
> (II) removing `topdirs.cmi` from `ocamlfind query compiler-libs`
> means
> that we split files for this library between two directories which is
> not good in general. Also, there is a probability that we can break
> compilation of some packages but I think that it is unlikely.
>=20
> Patches implementing both approaches are very likely to be very
> straightforward. We only need to decide right solution. Maybe we can
> even get it into 4.04.
>=20
> Kakadu
>=20
> [1] http://caml.inria.fr/mantis/view.php?id=3D6754
> [2]
> let () =3D
> =A0 try Topdirs.dir_directory (Sys.getenv "OCAML_TOPLEVEL_PATH")
> =A0 with Not_found -> ()
> ;;
>=20
--=20
------------------------------------------------------------
Gerd Stolpmann, Darmstadt, Germany    gerd@gerd-stolpmann.de
My OCaml site:          http://www.camlcity.org
Contact details:        http://www.camlcity.org/contact.html
Company homepage:       http://www.gerd-stolpmann.de
------------------------------------------------------------



--=-jsLQJE5laCGZc2+aKZpK
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: This is a digitally signed message part
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQEcBAABCAAGBQJXs2MXAAoJEAaM4b9ZLB5TtsIH/0nmbqekisMxD2yU28KRo/HQ
HDd8MhfX/S7UsST8y4+VWTtmnAeOQ8GOY9nHBj38vhv+3ZQbRIgLmdWkUTvaU6Z4
YLl+wz6igdI2qRd8cffJeL6Wh4syHcDiaa7V+AuYg9LS6aYG4hfIOgHN2xIxxqVY
UV6xgFbXoWQF+wJBfffTxioOH/zQUC7rr2pJ+OFSA4GCS4fW0W1V+dJrJppPaU2u
a+FOAWLjqH2/eYhnMAp3/8B7Fl6rphZ9g29rn5bB2tqJglijyXv4djfiTM4r5oOk
gNzG7X1keRt1j2wwHJqukRfU+zVKXFWdEn17ULpbXgyfLSR0SS3GV4F1644XUQ8=
=kTlD
-----END PGP SIGNATURE-----

--=-jsLQJE5laCGZc2+aKZpK--

