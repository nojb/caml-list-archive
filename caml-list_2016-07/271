Return-Path: <info@gerd-stolpmann.de>
X-Original-To: caml-list@sympa.inria.fr
Delivered-To: caml-list@sympa.inria.fr
Received: from mail3-relais-sop.national.inria.fr (mail3-relais-sop.national.inria.fr [192.134.164.104])
	by sympa.inria.fr (Postfix) with ESMTPS id 9F6777FDE1
	for <caml-list@sympa.inria.fr>; Wed, 27 Jul 2016 20:24:12 +0200 (CEST)
IronPort-PHdr: 9a23:PtU8MhfSQ2OyMQK8VwN3nx3klGMj4u6mDksu8pMizoh2WeGdxc69ZR7h7PlgxGXEQZ/co6odzbGH6+a+BCdZuMbJmUtBWaQEbwUCh8QSkl5oK+++Imq/EsTXaTcnFt9JTl5v8iLzG0FUHMHjew+a+SXqvnYsExnyfTB4Ov7yUtaLyZ/mj6bsptaKOlUArQH+SIs6FA+xowTVu5teqqpZAYF19CH0pGBVcf9d32JiKAHbtR/94sCt4MwrqHwI6LoJvvRNWqTifqk+UacQTHF/azh0t4XXskzqQRGO631UdGwanwAAVwHJ9hD3WL/3tTf58O1n13/JE9fxSOUbVC6up5x3TxvwjS4BMXZt8WfZjeR/gbhX5Qm9oBhnxofSZseZOawtLevmYdoGSD8ZDY5qXCtbD9b5NtNXAg==
Authentication-Results: mail3-smtp-sop.national.inria.fr; spf=None smtp.pra=info@gerd-stolpmann.de; spf=None smtp.mailfrom=info@gerd-stolpmann.de; spf=None smtp.helo=postmaster@mout.kundenserver.de
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  info@gerd-stolpmann.de) identity=pra;
  client-ip=217.72.192.73;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="info@gerd-stolpmann.de";
  x-sender="info@gerd-stolpmann.de";
  x-conformance=sidf_compatible
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  info@gerd-stolpmann.de) identity=mailfrom;
  client-ip=217.72.192.73;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="info@gerd-stolpmann.de";
  x-sender="info@gerd-stolpmann.de";
  x-conformance=sidf_compatible
Received-SPF: None (mail3-smtp-sop.national.inria.fr: no sender
  authenticity information available from domain of
  postmaster@mout.kundenserver.de) identity=helo;
  client-ip=217.72.192.73;
  receiver=mail3-smtp-sop.national.inria.fr;
  envelope-from="info@gerd-stolpmann.de";
  x-sender="postmaster@mout.kundenserver.de";
  x-conformance=sidf_compatible
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: A0A4AABm+5hXh0nASNldhBV8uHSBfSCFfQKBNjgUAQEBAQEBAQERAQEBCA0JCRkvgjIEARIBghMBBVUkEAsYLlcGEwmILAEJvD0BAQEBAQUBAQEBFQ6FMoVFhEyFMh0FiCORDoE8Ao0+iVEEhWuMLYN4HoJXgVlsAYZ7KoEaAQEB
X-IPAS-Result: A0A4AABm+5hXh0nASNldhBV8uHSBfSCFfQKBNjgUAQEBAQEBAQERAQEBCA0JCRkvgjIEARIBghMBBVUkEAsYLlcGEwmILAEJvD0BAQEBAQUBAQEBFQ6FMoVFhEyFMh0FiCORDoE8Ao0+iVEEhWuMLYN4HoJXgVlsAYZ7KoEaAQEB
X-IronPort-AV: E=Sophos;i="5.28,430,1464645600"; 
   d="asc'?scan'208";a="186136193"
Received: from mout.kundenserver.de ([217.72.192.73])
  by mail3-smtp-sop.national.inria.fr with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 27 Jul 2016 20:24:11 +0200
Received: from office1.lan.sumadev.de ([84.59.227.87]) by
 mrelayeu.kundenserver.de (mreue101) with ESMTPSA (Nemesis) id
 0MJCI6-1bQonz2eEM-002myt; Wed, 27 Jul 2016 20:24:09 +0200
Received: from [192.168.65.10] (unknown [192.168.65.10])
	by office1.lan.sumadev.de (Postfix) with ESMTPSA id A4D1DDC05D;
	Wed, 27 Jul 2016 20:24:08 +0200 (CEST)
Message-ID: <1469643843.26353.16.camel@e130.lan.sumadev.de>
From: Gerd Stolpmann <info@gerd-stolpmann.de>
To: Adrien Nader <adrien@notk.org>
Cc: Dmitriy Musatkin <dmleaper@gmail.com>, caml-list@inria.fr
Date: Wed, 27 Jul 2016 20:24:03 +0200
In-Reply-To: <20160727165635.GA19492@notk.org>
References: 
	<CA+g5CH0iOgJPDMA6nEL2q3Ob_8N0G8zQHThQaAVLFJQOmomhVw@mail.gmail.com>
	 <20160727165635.GA19492@notk.org>
Content-Type: multipart/signed; micalg="pgp-sha1"; protocol="application/pgp-signature";
	boundary="=-tDwIgtUBQsRDdaNor6Pt"
X-Mailer: Evolution 3.10.4-0ubuntu2 
Mime-Version: 1.0
X-Provags-ID: V03:K0:jC/q7BffkbMV2WylUn9qTBAsG9ACd2GbMXgzcrH2iXq/Bp4jkE0
 ty6rkN5FfVHK5MAihsonnu1wJNMDGZTX3UFOJmE9tXR7ObB+1Pvkh54D6hjOAdde4T9+GPz
 QlBRfE0VW/hcd5MSlefU4CVZPT6hilZgJ7CrLo+2fHd5N59PaI5iz7HWcW5i60iz9jNwLHO
 OHYektpJyTE/xq/X3QgkA==
X-UI-Out-Filterresults: notjunk:1;V01:K0:FsTov6wMBcw=:ZyQ8DaNy4DH8oQOpreRnuX
 4XslGomAIyQxkV+uZhQdTD3OvFgHTcPXhpQCKSp8wh5gr92i3EDzitrbre5EGIFyh/TT39mlL
 Eusyz5V7gSAuchJ1aC2WBcT1KVkwSAWkUdMH+fjPURl3yMXtfo5j+HFoeCHy+gmeGpWLAfnPg
 1BKerdCwhmUvSLeYF2F9sieSSKrb1e3nQmAOQucZL5nFOdO79zf+kld1szedqOtQ+sAcFZ6on
 12HPyCqOoXRrG9K6lTTRnM+dx5YABs3MucHby4tdILvHVqGCggR1UbH8Rmr2ocrSnj2eCWMfj
 dECHsVwyG6ehEw1ALs+KpUXfIpcLuU5bHGPJRwTbHoSMhDLVR7jqdYyX+VkJr8Z/Hk6Rf5AHt
 VYJY11wFqU2VAXntuJktlkVHdpo6lZWp0oq/JCrmmqC2S8iyRFKK38z4H7BYIvlUYEKWzydTB
 9BIXq1EF4veN1KAF/oRWWRUMxjYTXbulQq5akVVsHIOEYU1hWtW12uCuDY60K8iCfFjxeQSbm
 Iwe67oRKcPa4OCFaLfIHwNm/2B3NHxkiOQqInBLSh8753VngtvKz/2v809zJZlim8orYMfnCN
 BQ6Bcv/Sroacp3LDcSDcdHt1IcQvCRoyN8XDrj8BE029D2W5JAQ7/GCJJP+KRYyp9JIwoFrsQ
 czPnyWs5g+bsh50Hrvb0GHjMfrhPcTzL26uH0NWcUxwNWWIKUzThfA37bmRtjZRcBQXg=
Subject: Re: [Caml-list] Strange File IO bug


--=-tDwIgtUBQsRDdaNor6Pt
Content-Type: text/plain; charset="ISO-8859-15"
Content-Transfer-Encoding: quoted-printable

Am Mittwoch, den 27.07.2016, 18:56 +0200 schrieb Adrien Nader:
> Hi,
>=20
> On Tue, Jul 26, 2016, Dmitriy Musatkin wrote:
> > Hi all,
> >=20
> > I maintain a small OCaml program that generates some data, writes it to=
 a
> > temporary file and creates another process, which then reads that tempo=
rary
> > file. Recently, I've received a few reports from users that the program
> > generates an empty file when it should not. All of the affected users r=
un
> > either 64bit Win7 or Win10. I have access to one of those users' machin=
es,
> > and I can reproduce the issue consistently, however I'm not able to
> > reproduce the issue on any other machine.
> >=20
> > The file io part looks something like following:
> > let oc =3D open_out_bin file in
> > output_string oc s;
> > close_out oc
> >=20
>=20
> Most probably, "flush oc" before "close oc": out_channel is buffered. :)=
=20

No. close implies flush.

Another cause could be a network drive, and a synchronization issue.

Gerd



> --=20
> Adrien Nader
>=20

--=20
------------------------------------------------------------
Gerd Stolpmann, Darmstadt, Germany    gerd@gerd-stolpmann.de
My OCaml site:          http://www.camlcity.org
Contact details:        http://www.camlcity.org/contact.html
Company homepage:       http://www.gerd-stolpmann.de
------------------------------------------------------------


--=-tDwIgtUBQsRDdaNor6Pt
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: This is a digitally signed message part
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAABAgAGBQJXmPxDAAoJEAaM4b9ZLB5TQ5sH/jZlHuZFEW/64xEmQm6yWVy0
F9RcCgu3uBdJL3kGWetZtVKlvbGx2ngfR+hZE2FLRiO799u3VFw0HRKXqD6GHCci
R6fYama+0PAsRsw4zej9leqxfSfhiSEe0PikeSzeWU8WvJz0NBu9z7/tva3Xkm1b
ot5gmmDk5smqdxWh+GkNZqXCPTjtCotbu3iD0sV/BAv+bpTTaGhHrsZ7wVSPXd60
xWVfmUCoH8F5MAbc65FNCQWsTtZwH+82SKDy+49//hKFdWKwDbhWqnIabm6kk6l1
ebuwjUvvHgA9euePEQMZ8j6jTKdwKVhtlrecF9uR1I9jQc/bHkhaq2GliNnQyw0=
=wk67
-----END PGP SIGNATURE-----

--=-tDwIgtUBQsRDdaNor6Pt--

